(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,987972,362197,673468,e=>{"use strict";let t,r,n;class o{max;list;isRunning;constructor(e=1){this.max=e,this.list=[],this.isRunning=!1}push(e){this.list.push(e),this.isRunning||this.do()}async do(){if(0===this.list.length){this.isRunning=!1;return}this.isRunning=!0;let e=[];for(let t=0;t<this.max;t++){let t=this.list.shift();t&&e.push(t)}let t=e.map(e=>e());await Promise.all(t),await this.do()}}e.s(["Queue",()=>o],987972);let i=new URL("gif.wasm",location.origin).toString(),a=(s=(s="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/ROOT/src/tools/graphics/image-converter/engines/GifWasmModule.js",u=function(e){var t,r,n,o,a,u,c,f,l,d,h,m,p,w,g,v,y=void 0!==(e=e||{})?e:{};y.ready=new Promise(function(e,r){t=e}),y.preRun=y.preRun||[],y.preRun.push(function(){if(y.folder&&y.folder.length)for(let e=0;e<y.folder.length;e++){let t=y.folder[e];ea.mkdir(t)}ea.mkdir("/tem"),ea.mkdir("/out");let e=y.input;for(let t=0;t<e.length;t++){let r=e[t];ea.writeFile("/"+r.name,new Uint8Array(r.file))}}),y.postRun=y.postRun||[],y.postRun.push(function(){let e=[],t=ea.readdir("/out");t.splice(0,2);for(let r=0;r<t.length;r++){let n=t[r],o=ea.readFile("/out/"+n);e.push({file:o,name:n})}y.output(e)});var E={};for(r in y)y.hasOwnProperty(r)&&(E[r]=y[r]);var b=[],k="./this.program",_=function(e,t){throw t},D="function"==typeof importScripts,x="";D?x=self.location.href:document.currentScript&&(x=document.currentScript.src),s&&(x=s),x=0!==x.indexOf("blob:")?x.substr(0,x.lastIndexOf("/")+1):"",n=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},D&&(o=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)});var S=y.print||console.log.bind(console),R=y.printErr||console.warn.bind(console);for(r in E)E.hasOwnProperty(r)&&(y[r]=E[r]);E=null,y.arguments&&(b=y.arguments),y.thisProgram&&(k=y.thisProgram),y.quit&&(_=y.quit),y.wasmBinary&&(a=y.wasmBinary),y.noExitRuntime&&(u=y.noExitRuntime),"object"!=typeof WebAssembly&&R("no native wasm support detected");var P=new WebAssembly.Table({initial:64,maximum:64,element:"anyfunc"}),A=!1,M="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function F(e,t,r){for(var n=t+r,o=t;e[o]&&!(o>=n);)++o;if(o-t>16&&e.subarray&&M)return M.decode(e.subarray(t,o));for(var i="";t<o;){var a=e[t++];if(!(128&a)){i+=String.fromCharCode(a);continue}var s=63&e[t++];if((224&a)==192){i+=String.fromCharCode((31&a)<<6|s);continue}var u=63&e[t++];if((a=(240&a)==224?(15&a)<<12|s<<6|u:(7&a)<<18|s<<12|u<<6|63&e[t++])<65536)i+=String.fromCharCode(a);else{var c=a-65536;i+=String.fromCharCode(55296|c>>10,56320|1023&c)}}return i}function B(e,t){return e?F(d,e,t):""}function j(e,t,r,n){if(!(n>0))return 0;for(var o=r,i=r+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(r>=i)break;t[r++]=s}else if(s<=2047){if(r+1>=i)break;t[r++]=192|s>>6,t[r++]=128|63&s}else if(s<=65535){if(r+2>=i)break;t[r++]=224|s>>12,t[r++]=128|s>>6&63,t[r++]=128|63&s}else{if(r+3>=i)break;t[r++]=240|s>>18,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}}return t[r]=0,r-o}function O(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++r)),n<=127?++t:n<=2047?t+=2:n<=65535?t+=3:t+=4}return t}function T(e){var t=O(e)+1,r=ew(t);return j(e,l,r,t),r}function L(e){f=e,y.HEAP8=l=new Int8Array(e),y.HEAP16=h=new Int16Array(e),y.HEAP32=m=new Int32Array(e),y.HEAPU8=d=new Uint8Array(e),y.HEAPU16=new Uint16Array(e),y.HEAPU32=new Uint32Array(e),y.HEAPF32=new Float32Array(e),y.HEAPF64=new Float64Array(e)}var C=y.INITIAL_MEMORY||0x1000000;function z(e){for(;e.length>0;){var t=e.shift();if("function"==typeof t){t(y);continue}var r=t.func;"number"==typeof r?void 0===t.arg?y.dynCall_v(r):y.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}}(c=y.wasmMemory?y.wasmMemory:new WebAssembly.Memory({initial:C/65536,maximum:32768}))&&(f=c.buffer),C=f.byteLength,L(f),m[9776]=5282144;var I=[],N=[],U=[],H=[],W=Math.abs,q=Math.ceil,$=Math.floor,X=Math.min,G=0,V=null;function K(e){G++,y.monitorRunDependencies&&y.monitorRunDependencies(G)}function Q(e){if(G--,y.monitorRunDependencies&&y.monitorRunDependencies(G),0==G&&V){var t=V;V=null,t()}}function Y(e){throw y.onAbort&&y.onAbort(e),S(e+=""),R(e),A=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function Z(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}function J(e){return Z(e,"file://")}function ee(){try{if(a)return new Uint8Array(a);if(o)return o(i);throw"both async and sync fetching of the wasm failed"}catch(e){Y(e)}}function et(e){return m[ep()>>2]=e,e}y.preloadedImages={},y.preloadedAudios={},N.push({func:function(){eh()}}),g="undefined"!=typeof dateNow?dateNow:function(){return performance.now()};var er={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),r="/"===e.substr(-1);return(e=er.normalizeArray(e.split("/").filter(function(e){return!!e}),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=er.splitPath(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},basename:function(e){if("/"===e)return"/";var t=e.lastIndexOf("/");return -1===t?e:e.substr(t+1)},extname:function(e){return er.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return er.normalize(e.join("/"))},join2:function(e,t){return er.normalize(e+"/"+t)}},en={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:ea.cwd();if("string"!=typeof n)throw TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t="/"===n.charAt(0)}return e=er.normalizeArray(e.split("/").filter(function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."},relative:function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=en.resolve(e).substr(1),t=en.resolve(t).substr(1);for(var n=r(e.split("/")),o=r(t.split("/")),i=Math.min(n.length,o.length),a=i,s=0;s<i;s++)if(n[s]!==o[s]){a=s;break}for(var u=[],s=a;s<n.length;s++)u.push("..");return(u=u.concat(o.slice(a))).join("/")}},eo={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){eo.ttys[e]={input:[],output:[],ops:t},ea.registerDevice(e,eo.stream_ops)},stream_ops:{open:function(e){var t=eo.ttys[e.node.rdev];if(!t)throw new ea.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,r,n,o){if(!e.tty||!e.tty.ops.get_char)throw new ea.ErrnoError(60);for(var i,a=0,s=0;s<n;s++){try{i=e.tty.ops.get_char(e.tty)}catch(e){throw new ea.ErrnoError(29)}if(void 0===i&&0===a)throw new ea.ErrnoError(6);if(null==i)break;a++,t[r+s]=i}return a&&(e.node.timestamp=Date.now()),a},write:function(e,t,r,n,o){if(!e.tty||!e.tty.ops.put_char)throw new ea.ErrnoError(60);try{for(var i=0;i<n;i++)e.tty.ops.put_char(e.tty,t[r+i])}catch(e){throw new ea.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),i}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if("function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n"),!t)return null;e.input=el(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(S(F(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(S(F(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(R(F(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(R(F(e.output,0)),e.output=[])}}},ei={ops_table:null,mount:function(e){return ei.createNode(null,"/",16895,0)},createNode:function(e,t,r,n){if(ea.isBlkdev(r)||ea.isFIFO(r))throw new ea.ErrnoError(63);ei.ops_table||(ei.ops_table={dir:{node:{getattr:ei.node_ops.getattr,setattr:ei.node_ops.setattr,lookup:ei.node_ops.lookup,mknod:ei.node_ops.mknod,rename:ei.node_ops.rename,unlink:ei.node_ops.unlink,rmdir:ei.node_ops.rmdir,readdir:ei.node_ops.readdir,symlink:ei.node_ops.symlink},stream:{llseek:ei.stream_ops.llseek}},file:{node:{getattr:ei.node_ops.getattr,setattr:ei.node_ops.setattr},stream:{llseek:ei.stream_ops.llseek,read:ei.stream_ops.read,write:ei.stream_ops.write,allocate:ei.stream_ops.allocate,mmap:ei.stream_ops.mmap,msync:ei.stream_ops.msync}},link:{node:{getattr:ei.node_ops.getattr,setattr:ei.node_ops.setattr,readlink:ei.node_ops.readlink},stream:{}},chrdev:{node:{getattr:ei.node_ops.getattr,setattr:ei.node_ops.setattr},stream:ea.chrdev_stream_ops}});var o=ea.createNode(e,t,r,n);return ea.isDir(o.mode)?(o.node_ops=ei.ops_table.dir.node,o.stream_ops=ei.ops_table.dir.stream,o.contents={}):ea.isFile(o.mode)?(o.node_ops=ei.ops_table.file.node,o.stream_ops=ei.ops_table.file.stream,o.usedBytes=0,o.contents=null):ea.isLink(o.mode)?(o.node_ops=ei.ops_table.link.node,o.stream_ops=ei.ops_table.link.stream):ea.isChrdev(o.mode)&&(o.node_ops=ei.ops_table.chrdev.node,o.stream_ops=ei.ops_table.chrdev.stream),o.timestamp=Date.now(),e&&(e.contents[t]=o),o},getFileDataAsRegularArray:function(e){if(e.contents&&e.contents.subarray){for(var t=[],r=0;r<e.usedBytes;++r)t.push(e.contents[r]);return t}return e.contents},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){t=Math.max(t,r*(r<1048576?2:1.125)>>>0),0!=r&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t){if(0==t){e.contents=null,e.usedBytes=0;return}if(!e.contents||e.contents.subarray){var r=e.contents;e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t;return}if(e.contents||(e.contents=[]),e.contents.length>t)e.contents.length=t;else for(;e.contents.length<t;)e.contents.push(0);e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=ea.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,ea.isDir(e.mode)?t.size=4096:ea.isFile(e.mode)?t.size=e.usedBytes:ea.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&ei.resizeFileStorage(e,t.size)},lookup:function(e,t){throw ea.genericErrors[44]},mknod:function(e,t,r,n){return ei.createNode(e,t,r,n)},rename:function(e,t,r){if(ea.isDir(e.mode)){var n;try{n=ea.lookupNode(t,r)}catch(e){}if(n)for(var o in n.contents)throw new ea.ErrnoError(55)}delete e.parent.contents[e.name],e.name=r,t.contents[r]=e,e.parent=t},unlink:function(e,t){delete e.contents[t]},rmdir:function(e,t){var r=ea.lookupNode(e,t);for(var n in r.contents)throw new ea.ErrnoError(55);delete e.contents[t]},readdir:function(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink:function(e,t,r){var n=ei.createNode(e,t,41471,0);return n.link=r,n},readlink:function(e){if(!ea.isLink(e.mode))throw new ea.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,r,n,o){var i=e.node.contents;if(o>=e.node.usedBytes)return 0;var a=Math.min(e.node.usedBytes-o,n);if(a>8&&i.subarray)t.set(i.subarray(o,o+a),r);else for(var s=0;s<a;s++)t[r+s]=i[o+s];return a},write:function(e,t,r,n,o,i){if(t.buffer===l.buffer&&(i=!1),!n)return 0;var a=e.node;if(a.timestamp=Date.now(),t.subarray&&(!a.contents||a.contents.subarray)){if(i)return a.contents=t.subarray(r,r+n),a.usedBytes=n,n;else if(0===a.usedBytes&&0===o)return a.contents=t.slice(r,r+n),a.usedBytes=n,n;else if(o+n<=a.usedBytes)return a.contents.set(t.subarray(r,r+n),o),n}if(ei.expandFileStorage(a,o+n),a.contents.subarray&&t.subarray)a.contents.set(t.subarray(r,r+n),o);else for(var s=0;s<n;s++)a.contents[o+s]=t[r+s];return a.usedBytes=Math.max(a.usedBytes,o+n),n},llseek:function(e,t,r){var n=t;if(1===r?n+=e.position:2===r&&ea.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new ea.ErrnoError(28);return n},allocate:function(e,t,r){ei.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap:function(e,t,r,n,o,i){if(0!==t&&Y("Assertion failed: undefined"),!ea.isFile(e.node.mode))throw new ea.ErrnoError(43);var a,s,u=e.node.contents;if(2&i||u.buffer!==f){if((n>0||n+r<u.length)&&(u=u.subarray?u.subarray(n,n+r):Array.prototype.slice.call(u,n,n+r)),s=!0,!(a=em(r)))throw new ea.ErrnoError(48);l.set(u,a)}else s=!1,a=u.byteOffset;return{ptr:a,allocated:s}},msync:function(e,t,r,n,o){if(!ea.isFile(e.node.mode))throw new ea.ErrnoError(43);return 2&o||ei.stream_ops.write(e,t,0,n,r,!1),0}}},ea={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(e){if(!(e instanceof ea.ErrnoError)){var t;throw e+" : "+(t=function(){var e=Error();if(!e.stack){try{throw Error()}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}(),y.extraStackTrace&&(t+="\n"+y.extraStackTrace()),t.replace(/\b_Z[\w\d_]+/g,function(e){return e==e?e:e+" ["+e+"]"}))}return et(e.errno)},lookupPath:function(e,t){if(e=en.resolve(ea.cwd(),e),t=t||{},!e)return{path:"",node:null};var r={follow_mount:!0,recurse_count:0};for(var n in r)void 0===t[n]&&(t[n]=r[n]);if(t.recurse_count>8)throw new ea.ErrnoError(32);for(var o=er.normalizeArray(e.split("/").filter(function(e){return!!e}),!1),i=ea.root,a="/",s=0;s<o.length;s++){var u=s===o.length-1;if(u&&t.parent)break;if(i=ea.lookupNode(i,o[s]),a=er.join2(a,o[s]),ea.isMountpoint(i)&&(!u||u&&t.follow_mount)&&(i=i.mounted.root),!u||t.follow)for(var c=0;ea.isLink(i.mode);){var f=ea.readlink(a);if(a=en.resolve(er.dirname(a),f),i=ea.lookupPath(a,{recurse_count:t.recurse_count}).node,c++>40)throw new ea.ErrnoError(32)}}return{path:a,node:i}},getPath:function(e){for(var t;;){if(ea.isRoot(e)){var r=e.mount.mountpoint;if(!t)return r;return"/"!==r[r.length-1]?r+"/"+t:r+t}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%ea.nameTable.length},hashAddNode:function(e){var t=ea.hashName(e.parent.id,e.name);e.name_next=ea.nameTable[t],ea.nameTable[t]=e},hashRemoveNode:function(e){var t=ea.hashName(e.parent.id,e.name);if(ea.nameTable[t]===e)ea.nameTable[t]=e.name_next;else for(var r=ea.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode:function(e,t){var r=ea.mayLookup(e);if(r)throw new ea.ErrnoError(r,e);for(var n=ea.hashName(e.id,t),o=ea.nameTable[n];o;o=o.name_next){var i=o.name;if(o.parent.id===e.id&&i===t)return o}return ea.lookup(e,t)},createNode:function(e,t,r,n){var o=new ea.FSNode(e,t,r,n);return ea.hashAddNode(o),o},destroyNode:function(e){ea.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return(61440&e)==32768},isDir:function(e){return(61440&e)==16384},isLink:function(e){return(61440&e)==40960},isChrdev:function(e){return(61440&e)==8192},isBlkdev:function(e){return(61440&e)==24576},isFIFO:function(e){return(61440&e)==4096},isSocket:function(e){return(49152&e)==49152},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(e){var t=ea.flagModes[e];if(void 0===t)throw Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return ea.ignorePermissions?0:2*(-1!==t.indexOf("r")&&!(292&e.mode)||-1!==t.indexOf("w")&&!(146&e.mode)||-1!==t.indexOf("x")&&!(73&e.mode))},mayLookup:function(e){var t=ea.nodePermissions(e,"x");return t||2*!e.node_ops.lookup},mayCreate:function(e,t){try{return ea.lookupNode(e,t),20}catch(e){}return ea.nodePermissions(e,"wx")},mayDelete:function(e,t,r){try{n=ea.lookupNode(e,t)}catch(e){return e.errno}var n,o=ea.nodePermissions(e,"wx");if(o)return o;if(r){if(!ea.isDir(n.mode))return 54;if(ea.isRoot(n)||ea.getPath(n)===ea.cwd())return 10}else if(ea.isDir(n.mode))return 31;return 0},mayOpen:function(e,t){return e?ea.isLink(e.mode)?32:ea.isDir(e.mode)&&("r"!==ea.flagsToPermissionString(t)||512&t)?31:ea.nodePermissions(e,ea.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||ea.MAX_OPEN_FDS;for(var r=e;r<=t;r++)if(!ea.streams[r])return r;throw new ea.ErrnoError(33)},getStream:function(e){return ea.streams[e]},createStream:function(e,t,r){ea.FSStream||(ea.FSStream=function(){},ea.FSStream.prototype={object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return(2097155&this.flags)!=1}},isWrite:{get:function(){return(2097155&this.flags)!=0}},isAppend:{get:function(){return 1024&this.flags}}});var n=new ea.FSStream;for(var o in e)n[o]=e[o];e=n;var i=ea.nextfd(t,r);return e.fd=i,ea.streams[i]=e,e},closeStream:function(e){ea.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=ea.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new ea.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){ea.devices[e]={stream_ops:t}},getDevice:function(e){return ea.devices[e]},getMounts:function(e){for(var t=[],r=[e];r.length;){var n=r.pop();t.push(n),r.push.apply(r,n.mounts)}return t},syncfs:function(e,t){"function"==typeof e&&(t=e,e=!1),ea.syncFSRequests++,ea.syncFSRequests>1&&R("warning: "+ea.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var r=ea.getMounts(ea.root.mount),n=0;function o(e){return ea.syncFSRequests--,t(e)}function i(e){if(e)return i.errored?void 0:(i.errored=!0,o(e));++n>=r.length&&o(null)}r.forEach(function(t){if(!t.type.syncfs)return i(null);t.type.syncfs(t,e,i)})},mount:function(e,t,r){var n,o="/"===r,i=!r;if(o&&ea.root)throw new ea.ErrnoError(10);if(!o&&!i){var a=ea.lookupPath(r,{follow_mount:!1});if(r=a.path,n=a.node,ea.isMountpoint(n))throw new ea.ErrnoError(10);if(!ea.isDir(n.mode))throw new ea.ErrnoError(54)}var s={type:e,opts:t,mountpoint:r,mounts:[]},u=e.mount(s);return u.mount=s,s.root=u,o?ea.root=u:n&&(n.mounted=s,n.mount&&n.mount.mounts.push(s)),u},unmount:function(e){var t=ea.lookupPath(e,{follow_mount:!1});if(!ea.isMountpoint(t.node))throw new ea.ErrnoError(28);var r=t.node,n=r.mounted,o=ea.getMounts(n);Object.keys(ea.nameTable).forEach(function(e){for(var t=ea.nameTable[e];t;){var r=t.name_next;-1!==o.indexOf(t.mount)&&ea.destroyNode(t),t=r}}),r.mounted=null;var i=r.mount.mounts.indexOf(n);r.mount.mounts.splice(i,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,r){var n=ea.lookupPath(e,{parent:!0}).node,o=er.basename(e);if(!o||"."===o||".."===o)throw new ea.ErrnoError(28);var i=ea.mayCreate(n,o);if(i)throw new ea.ErrnoError(i);if(!n.node_ops.mknod)throw new ea.ErrnoError(63);return n.node_ops.mknod(n,o,t,r)},create:function(e,t){return t=(void 0!==t?t:438)&4095|32768,ea.mknod(e,t,0)},mkdir:function(e,t){return t=(void 0!==t?t:511)&1023|16384,ea.mknod(e,t,0)},mkdirTree:function(e,t){for(var r=e.split("/"),n="",o=0;o<r.length;++o)if(r[o]){n+="/"+r[o];try{ea.mkdir(n,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:function(e,t,r){return void 0===r&&(r=t,t=438),t|=8192,ea.mknod(e,t,r)},symlink:function(e,t){if(!en.resolve(e))throw new ea.ErrnoError(44);var r=ea.lookupPath(t,{parent:!0}).node;if(!r)throw new ea.ErrnoError(44);var n=er.basename(t),o=ea.mayCreate(r,n);if(o)throw new ea.ErrnoError(o);if(!r.node_ops.symlink)throw new ea.ErrnoError(63);return r.node_ops.symlink(r,n,e)},rename:function(e,t){var r,n,o,i=er.dirname(e),a=er.dirname(t),s=er.basename(e),u=er.basename(t);try{r=ea.lookupPath(e,{parent:!0}).node,n=ea.lookupPath(t,{parent:!0}).node}catch(e){throw new ea.ErrnoError(10)}if(!r||!n)throw new ea.ErrnoError(44);if(r.mount!==n.mount)throw new ea.ErrnoError(75);var c=ea.lookupNode(r,s),f=en.relative(e,a);if("."!==f.charAt(0))throw new ea.ErrnoError(28);if("."!==(f=en.relative(t,i)).charAt(0))throw new ea.ErrnoError(55);try{o=ea.lookupNode(n,u)}catch(e){}if(c!==o){var l=ea.isDir(c.mode),d=ea.mayDelete(r,s,l);if(d||(d=o?ea.mayDelete(n,u,l):ea.mayCreate(n,u)))throw new ea.ErrnoError(d);if(!r.node_ops.rename)throw new ea.ErrnoError(63);if(ea.isMountpoint(c)||o&&ea.isMountpoint(o))throw new ea.ErrnoError(10);if(n!==r&&(d=ea.nodePermissions(r,"w")))throw new ea.ErrnoError(d);try{ea.trackingDelegate.willMovePath}catch(r){R("FS.trackingDelegate['willMovePath']('"+e+"', '"+t+"') threw an exception: "+r.message)}ea.hashRemoveNode(c);try{r.node_ops.rename(c,n,u)}catch(e){throw e}finally{ea.hashAddNode(c)}try{ea.trackingDelegate.onMovePath}catch(r){R("FS.trackingDelegate['onMovePath']('"+e+"', '"+t+"') threw an exception: "+r.message)}}},rmdir:function(e){var t=ea.lookupPath(e,{parent:!0}).node,r=er.basename(e),n=ea.lookupNode(t,r),o=ea.mayDelete(t,r,!0);if(o)throw new ea.ErrnoError(o);if(!t.node_ops.rmdir)throw new ea.ErrnoError(63);if(ea.isMountpoint(n))throw new ea.ErrnoError(10);try{ea.trackingDelegate.willDeletePath}catch(t){R("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}t.node_ops.rmdir(t,r),ea.destroyNode(n);try{ea.trackingDelegate.onDeletePath}catch(t){R("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readdir:function(e){var t=ea.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new ea.ErrnoError(54);return t.node_ops.readdir(t)},unlink:function(e){var t=ea.lookupPath(e,{parent:!0}).node,r=er.basename(e),n=ea.lookupNode(t,r),o=ea.mayDelete(t,r,!1);if(o)throw new ea.ErrnoError(o);if(!t.node_ops.unlink)throw new ea.ErrnoError(63);if(ea.isMountpoint(n))throw new ea.ErrnoError(10);try{ea.trackingDelegate.willDeletePath}catch(t){R("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}t.node_ops.unlink(t,r),ea.destroyNode(n);try{ea.trackingDelegate.onDeletePath}catch(t){R("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readlink:function(e){var t=ea.lookupPath(e).node;if(!t)throw new ea.ErrnoError(44);if(!t.node_ops.readlink)throw new ea.ErrnoError(28);return en.resolve(ea.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var r=ea.lookupPath(e,{follow:!t}).node;if(!r)throw new ea.ErrnoError(44);if(!r.node_ops.getattr)throw new ea.ErrnoError(63);return r.node_ops.getattr(r)},lstat:function(e){return ea.stat(e,!0)},chmod:function(e,t,r){var n;if(!(n="string"==typeof e?ea.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new ea.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod:function(e,t){ea.chmod(e,t,!0)},fchmod:function(e,t){var r=ea.getStream(e);if(!r)throw new ea.ErrnoError(8);ea.chmod(r.node,t)},chown:function(e,t,r,n){var o;if(!(o="string"==typeof e?ea.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new ea.ErrnoError(63);o.node_ops.setattr(o,{timestamp:Date.now()})},lchown:function(e,t,r){ea.chown(e,t,r,!0)},fchown:function(e,t,r){var n=ea.getStream(e);if(!n)throw new ea.ErrnoError(8);ea.chown(n.node,t,r)},truncate:function(e,t){if(t<0)throw new ea.ErrnoError(28);if("string"==typeof e){var r;r=ea.lookupPath(e,{follow:!0}).node}else r=e;if(!r.node_ops.setattr)throw new ea.ErrnoError(63);if(ea.isDir(r.mode))throw new ea.ErrnoError(31);if(!ea.isFile(r.mode))throw new ea.ErrnoError(28);var n=ea.nodePermissions(r,"w");if(n)throw new ea.ErrnoError(n);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var r=ea.getStream(e);if(!r)throw new ea.ErrnoError(8);if((2097155&r.flags)==0)throw new ea.ErrnoError(28);ea.truncate(r.node,t)},utime:function(e,t,r){var n=ea.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,r)})},open:function(e,t,r,n,o){if(""===e)throw new ea.ErrnoError(44);if(t="string"==typeof t?ea.modeStringToFlags(t):t,r=void 0===r?438:r,r=64&t?4095&r|32768:0,"object"==typeof e)i=e;else{e=er.normalize(e);try{var i;i=ea.lookupPath(e,{follow:!(131072&t)}).node}catch(e){}}var a=!1;if(64&t)if(i){if(128&t)throw new ea.ErrnoError(20)}else i=ea.mknod(e,r,0),a=!0;if(!i)throw new ea.ErrnoError(44);if(ea.isChrdev(i.mode)&&(t&=-513),65536&t&&!ea.isDir(i.mode))throw new ea.ErrnoError(54);if(!a){var s=ea.mayOpen(i,t);if(s)throw new ea.ErrnoError(s)}512&t&&ea.truncate(i,0),t&=-131713;var u=ea.createStream({node:i,path:ea.getPath(i),flags:t,seekable:!0,position:0,stream_ops:i.stream_ops,ungotten:[],error:!1},n,o);u.stream_ops.open&&u.stream_ops.open(u),y.logReadFiles&&!(1&t)&&(ea.readFiles||(ea.readFiles={}),e in ea.readFiles||(ea.readFiles[e]=1,R("FS.trackingDelegate error on read file: "+e)));try{ea.trackingDelegate.onOpenFile}catch(t){R("FS.trackingDelegate['onOpenFile']('"+e+"', flags) threw an exception: "+t.message)}return u},close:function(e){if(ea.isClosed(e))throw new ea.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{ea.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,r){if(ea.isClosed(e))throw new ea.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new ea.ErrnoError(70);if(0!=r&&1!=r&&2!=r)throw new ea.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read:function(e,t,r,n,o){if(n<0||o<0)throw new ea.ErrnoError(28);if(ea.isClosed(e)||(2097155&e.flags)==1)throw new ea.ErrnoError(8);if(ea.isDir(e.node.mode))throw new ea.ErrnoError(31);if(!e.stream_ops.read)throw new ea.ErrnoError(28);var i=void 0!==o;if(i){if(!e.seekable)throw new ea.ErrnoError(70)}else o=e.position;var a=e.stream_ops.read(e,t,r,n,o);return i||(e.position+=a),a},write:function(e,t,r,n,o,i){if(n<0||o<0)throw new ea.ErrnoError(28);if(ea.isClosed(e)||(2097155&e.flags)==0)throw new ea.ErrnoError(8);if(ea.isDir(e.node.mode))throw new ea.ErrnoError(31);if(!e.stream_ops.write)throw new ea.ErrnoError(28);e.seekable&&1024&e.flags&&ea.llseek(e,0,2);var a=void 0!==o;if(a){if(!e.seekable)throw new ea.ErrnoError(70)}else o=e.position;var s=e.stream_ops.write(e,t,r,n,o,i);a||(e.position+=s);try{e.path&&ea.trackingDelegate.onWriteToFile&&ea.trackingDelegate.onWriteToFile(e.path)}catch(t){R("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+t.message)}return s},allocate:function(e,t,r){if(ea.isClosed(e))throw new ea.ErrnoError(8);if(t<0||r<=0)throw new ea.ErrnoError(28);if((2097155&e.flags)==0)throw new ea.ErrnoError(8);if(!ea.isFile(e.node.mode)&&!ea.isDir(e.node.mode))throw new ea.ErrnoError(43);if(!e.stream_ops.allocate)throw new ea.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap:function(e,t,r,n,o,i){if((2&o)!=0&&(2&i)==0&&(2097155&e.flags)!=2||(2097155&e.flags)==1)throw new ea.ErrnoError(2);if(!e.stream_ops.mmap)throw new ea.ErrnoError(43);return e.stream_ops.mmap(e,t,r,n,o,i)},msync:function(e,t,r,n,o){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,r,n,o):0},munmap:function(e){return 0},ioctl:function(e,t,r){if(!e.stream_ops.ioctl)throw new ea.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile:function(e,t){if((t=t||{}).flags=t.flags||"r",t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw Error('Invalid encoding type "'+t.encoding+'"');var r,n=ea.open(e,t.flags),o=ea.stat(e).size,i=new Uint8Array(o);return ea.read(n,i,0,o,0),"utf8"===t.encoding?r=F(i,0):"binary"===t.encoding&&(r=i),ea.close(n),r},writeFile:function(e,t,r){(r=r||{}).flags=r.flags||"w";var n=ea.open(e,r.flags,r.mode);if("string"==typeof t){var o=new Uint8Array(O(t)+1),i=j(t,o,0,o.length);ea.write(n,o,0,i,void 0,r.canOwn)}else if(ArrayBuffer.isView(t))ea.write(n,t,0,t.byteLength,void 0,r.canOwn);else throw Error("Unsupported data type");ea.close(n)},cwd:function(){return ea.currentPath},chdir:function(e){var t=ea.lookupPath(e,{follow:!0});if(null===t.node)throw new ea.ErrnoError(44);if(!ea.isDir(t.node.mode))throw new ea.ErrnoError(54);var r=ea.nodePermissions(t.node,"x");if(r)throw new ea.ErrnoError(r);ea.currentPath=t.path},createDefaultDirectories:function(){ea.mkdir("/tmp"),ea.mkdir("/home"),ea.mkdir("/home/web_user")},createDefaultDevices:function(){if(ea.mkdir("/dev"),ea.registerDevice(ea.makedev(1,3),{read:function(){return 0},write:function(e,t,r,n,o){return n}}),ea.mkdev("/dev/null",ea.makedev(1,3)),eo.register(ea.makedev(5,0),eo.default_tty_ops),eo.register(ea.makedev(6,0),eo.default_tty1_ops),ea.mkdev("/dev/tty",ea.makedev(5,0)),ea.mkdev("/dev/tty1",ea.makedev(6,0)),"object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e,t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}e||(e=function(){Y("random_device")}),ea.createDevice("/dev","random",e),ea.createDevice("/dev","urandom",e),ea.mkdir("/dev/shm"),ea.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){ea.mkdir("/proc"),ea.mkdir("/proc/self"),ea.mkdir("/proc/self/fd"),ea.mount({mount:function(){var e=ea.createNode("/proc/self","fd",16895,73);return e.node_ops={lookup:function(e,t){var r=ea.getStream(+t);if(!r)throw new ea.ErrnoError(8);var n={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return r.path}}};return n.parent=n,n}},e}},{},"/proc/self/fd")},createStandardStreams:function(){y.stdin?ea.createDevice("/dev","stdin",y.stdin):ea.symlink("/dev/tty","/dev/stdin"),y.stdout?ea.createDevice("/dev","stdout",null,y.stdout):ea.symlink("/dev/tty","/dev/stdout"),y.stderr?ea.createDevice("/dev","stderr",null,y.stderr):ea.symlink("/dev/tty1","/dev/stderr"),ea.open("/dev/stdin","r"),ea.open("/dev/stdout","w"),ea.open("/dev/stderr","w")},ensureErrnoError:function(){ea.ErrnoError||(ea.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},ea.ErrnoError.prototype=Error(),ea.ErrnoError.prototype.constructor=ea.ErrnoError,[44].forEach(function(e){ea.genericErrors[e]=new ea.ErrnoError(e),ea.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:function(){ea.ensureErrnoError(),ea.nameTable=Array(4096),ea.mount(ei,{},"/"),ea.createDefaultDirectories(),ea.createDefaultDevices(),ea.createSpecialDirectories(),ea.filesystems={MEMFS:ei}},init:function(e,t,r){ea.init.initialized=!0,ea.ensureErrnoError(),y.stdin=e||y.stdin,y.stdout=t||y.stdout,y.stderr=r||y.stderr,ea.createStandardStreams()},quit:function(){ea.init.initialized=!1;var e=y._fflush;e&&e(0);for(var t=0;t<ea.streams.length;t++){var r=ea.streams[t];r&&ea.close(r)}},getMode:function(e,t){var r=0;return e&&(r|=365),t&&(r|=146),r},joinPath:function(e,t){var r=er.join.apply(null,e);return t&&"/"==r[0]&&(r=r.substr(1)),r},absolutePath:function(e,t){return en.resolve(t,e)},standardizePath:function(e){return er.normalize(e)},findObject:function(e,t){var r=ea.analyzePath(e,t);return r.exists?r.object:(et(r.error),null)},analyzePath:function(e,t){try{var r=ea.lookupPath(e,{follow:!t});e=r.path}catch(e){}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var r=ea.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=r.path,n.parentObject=r.node,n.name=er.basename(e),r=ea.lookupPath(e,{follow:!t}),n.exists=!0,n.path=r.path,n.object=r.node,n.name=r.node.name,n.isRoot="/"===r.path}catch(e){n.error=e.errno}return n},createFolder:function(e,t,r,n){var o=er.join2("string"==typeof e?e:ea.getPath(e),t),i=ea.getMode(r,n);return ea.mkdir(o,i)},createPath:function(e,t,r,n){e="string"==typeof e?e:ea.getPath(e);for(var o=t.split("/").reverse();o.length;){var i=o.pop();if(i){var a=er.join2(e,i);try{ea.mkdir(a)}catch(e){}e=a}}return a},createFile:function(e,t,r,n,o){var i=er.join2("string"==typeof e?e:ea.getPath(e),t),a=ea.getMode(n,o);return ea.create(i,a)},createDataFile:function(e,t,r,n,o,i){var a=t?er.join2("string"==typeof e?e:ea.getPath(e),t):e,s=ea.getMode(n,o),u=ea.create(a,s);if(r){if("string"==typeof r){for(var c=Array(r.length),f=0,l=r.length;f<l;++f)c[f]=r.charCodeAt(f);r=c}ea.chmod(u,146|s);var d=ea.open(u,"w");ea.write(d,r,0,r.length,0,i),ea.close(d),ea.chmod(u,s)}return u},createDevice:function(e,t,r,n){var o=er.join2("string"==typeof e?e:ea.getPath(e),t),i=ea.getMode(!!r,!!n);ea.createDevice.major||(ea.createDevice.major=64);var a=ea.makedev(ea.createDevice.major++,0);return ea.registerDevice(a,{open:function(e){e.seekable=!1},close:function(e){n&&n.buffer&&n.buffer.length&&n(10)},read:function(e,t,n,o,i){for(var a,s=0,u=0;u<o;u++){try{a=r()}catch(e){throw new ea.ErrnoError(29)}if(void 0===a&&0===s)throw new ea.ErrnoError(6);if(null==a)break;s++,t[n+u]=a}return s&&(e.node.timestamp=Date.now()),s},write:function(e,t,r,o,i){for(var a=0;a<o;a++)try{n(t[r+a])}catch(e){throw new ea.ErrnoError(29)}return o&&(e.node.timestamp=Date.now()),a}}),ea.mkdev(o,i,a)},createLink:function(e,t,r,n,o){var i=er.join2("string"==typeof e?e:ea.getPath(e),t);return ea.symlink(r,i)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;var t=!0;if("undefined"!=typeof XMLHttpRequest)throw Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(n)try{e.contents=el(n(e.url),!0),e.usedBytes=e.contents.length}catch(e){t=!1}else throw Error("Cannot load without read() or XMLHttpRequest.");return t||et(29),t},createLazyFile:function(e,t,r,n,o){function i(){this.lengthKnown=!1,this.chunks=[]}if(i.prototype.get=function(e){if(!(e>this.length-1)&&!(e<0)){var t=e%this.chunkSize,r=e/this.chunkSize|0;return this.getter(r)[t]}},i.prototype.setDataGetter=function(e){this.getter=e},i.prototype.cacheLength=function(){var e,t=new XMLHttpRequest;if(t.open("HEAD",r,!1),t.send(null),!(t.status>=200&&t.status<300||304===t.status))throw Error("Couldn't load "+r+". Status: "+t.status);var n=Number(t.getResponseHeader("Content-length")),o=(e=t.getResponseHeader("Accept-Ranges"))&&"bytes"===e,i=(e=t.getResponseHeader("Content-Encoding"))&&"gzip"===e,a=1048576;o||(a=n);var s=function(e,t){if(e>t)throw Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw Error("only "+n+" bytes available! programmer error!");var o=new XMLHttpRequest;if(o.open("GET",r,!1),n!==a&&o.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(o.responseType="arraybuffer"),o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined"),o.send(null),!(o.status>=200&&o.status<300||304===o.status))throw Error("Couldn't load "+r+". Status: "+o.status);return void 0!==o.response?new Uint8Array(o.response||[]):el(o.responseText||"",!0)},u=this;u.setDataGetter(function(e){var t=e*a,r=(e+1)*a-1;if(r=Math.min(r,n-1),void 0===u.chunks[e]&&(u.chunks[e]=s(t,r)),void 0===u.chunks[e])throw Error("doXHR failed!");return u.chunks[e]}),(i||!n)&&(a=n=1,a=n=this.getter(0).length,S("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=a,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!D)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var a=new i;Object.defineProperties(a,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var s={isDevice:!1,contents:a}}else var s={isDevice:!1,url:r};var u=ea.createFile(e,t,s,n,o);s.contents?u.contents=s.contents:s.url&&(u.contents=null,u.url=s.url),Object.defineProperties(u,{usedBytes:{get:function(){return this.contents.length}}});var c={};return Object.keys(u.stream_ops).forEach(function(e){var t=u.stream_ops[e];c[e]=function(){if(!ea.forceLoadFile(u))throw new ea.ErrnoError(29);return t.apply(null,arguments)}}),c.read=function(e,t,r,n,o){if(!ea.forceLoadFile(u))throw new ea.ErrnoError(29);var i=e.node.contents;if(o>=i.length)return 0;var a=Math.min(i.length-o,n);if(i.slice)for(var s=0;s<a;s++)t[r+s]=i[o+s];else for(var s=0;s<a;s++)t[r+s]=i.get(o+s);return a},u.stream_ops=c,u},createPreloadedFile:function(e,t,r,n,o,i,a,s,u,c){Browser.init();var f=t?en.resolve(er.join2(e,t)):e;function l(r){function l(r){c&&c(),s||ea.createDataFile(e,t,r,n,o,u),i&&i(),Q()}var d=!1;y.preloadPlugins.forEach(function(e){!d&&e.canHandle(f)&&(e.handle(r,f,l,function(){a&&a(),Q()}),d=!0)}),d||l(r)}K(),"string"==typeof r?Browser.asyncLoad(r,function(e){l(e)},a):l(r)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,r){t=t||function(){},r=r||function(){};var n=ea.indexedDB();try{var o=n.open(ea.DB_NAME(),ea.DB_VERSION)}catch(e){return r(e)}o.onupgradeneeded=function(){S("creating db"),o.result.createObjectStore(ea.DB_STORE_NAME)},o.onsuccess=function(){var n=o.result.transaction([ea.DB_STORE_NAME],"readwrite"),i=n.objectStore(ea.DB_STORE_NAME),a=0,s=0,u=e.length;function c(){0==s?t():r()}e.forEach(function(e){var t=i.put(ea.analyzePath(e).object.contents,e);t.onsuccess=function(){++a+s==u&&c()},t.onerror=function(){s++,a+s==u&&c()}}),n.onerror=r},o.onerror=r},loadFilesFromDB:function(e,t,r){t=t||function(){},r=r||function(){};var n=ea.indexedDB();try{var o=n.open(ea.DB_NAME(),ea.DB_VERSION)}catch(e){return r(e)}o.onupgradeneeded=r,o.onsuccess=function(){var n=o.result;try{var i=n.transaction([ea.DB_STORE_NAME],"readonly")}catch(e){r(e);return}var a=i.objectStore(ea.DB_STORE_NAME),s=0,u=0,c=e.length;function f(){0==u?t():r()}e.forEach(function(e){var t=a.get(e);t.onsuccess=function(){ea.analyzePath(e).exists&&ea.unlink(e),ea.createDataFile(er.dirname(e),er.basename(e),t.result,!0,!0,!0),++s+u==c&&f()},t.onerror=function(){u++,s+u==c&&f()}}),i.onerror=r},o.onerror=r}},es={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(e,t){if("/"!==t[0]){var r;if(-100===e)r=ea.cwd();else{var n=ea.getStream(e);if(!n)throw new ea.ErrnoError(8);r=n.path}t=er.join2(r,t)}return t},doStat:function(e,t,r){try{var n=e(t)}catch(e){if(e&&e.node&&er.normalize(t)!==er.normalize(ea.getPath(e.node)))return -54;throw e}return m[r>>2]=n.dev,m[r+4>>2]=0,m[r+8>>2]=n.ino,m[r+12>>2]=n.mode,m[r+16>>2]=n.nlink,m[r+20>>2]=n.uid,m[r+24>>2]=n.gid,m[r+28>>2]=n.rdev,m[r+32>>2]=0,w=[n.size>>>0,+W(p=n.size)>=1?p>0?X(+$(p/0x100000000),0xffffffff)>>>0:~~q((p-(~~p>>>0))/0x100000000)>>>0:0],m[r+40>>2]=w[0],m[r+44>>2]=w[1],m[r+48>>2]=4096,m[r+52>>2]=n.blocks,m[r+56>>2]=n.atime.getTime()/1e3|0,m[r+60>>2]=0,m[r+64>>2]=n.mtime.getTime()/1e3|0,m[r+68>>2]=0,m[r+72>>2]=n.ctime.getTime()/1e3|0,m[r+76>>2]=0,w=[n.ino>>>0,+W(p=n.ino)>=1?p>0?X(+$(p/0x100000000),0xffffffff)>>>0:~~q((p-(~~p>>>0))/0x100000000)>>>0:0],m[r+80>>2]=w[0],m[r+84>>2]=w[1],0},doMsync:function(e,t,r,n,o){var i=d.slice(e,e+r);ea.msync(t,i,o,r,n)},doMkdir:function(e,t){return"/"===(e=er.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),ea.mkdir(e,t,0),0},doMknod:function(e,t,r){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return -28}return ea.mknod(e,t,r),0},doReadlink:function(e,t,r){if(r<=0)return -28;var n=ea.readlink(e),o=Math.min(r,O(n)),i=l[t+o];return j(n,d,t,r+1),l[t+o]=i,o},doAccess:function(e,t){if(-8&t)return -28;if(!(r=ea.lookupPath(e,{follow:!0}).node))return -44;var r,n="";return(4&t&&(n+="r"),2&t&&(n+="w"),1&t&&(n+="x"),n&&ea.nodePermissions(r,n))?-2:0},doDup:function(e,t,r){var n=ea.getStream(r);return n&&ea.close(n),ea.open(e,t,0,r,r).fd},doReadv:function(e,t,r,n){for(var o=0,i=0;i<r;i++){var a=m[t+8*i>>2],s=m[t+(8*i+4)>>2],u=ea.read(e,l,a,s,n);if(u<0)return -1;if(o+=u,u<s)break}return o},doWritev:function(e,t,r,n){for(var o=0,i=0;i<r;i++){var a=m[t+8*i>>2],s=m[t+(8*i+4)>>2],u=ea.write(e,l,a,s,n);if(u<0)return -1;o+=u}return o},varargs:void 0,get:function(){return es.varargs+=4,m[es.varargs-4>>2]},getStr:function(e){return B(e)},getStreamFromFD:function(e){var t=ea.getStream(e);if(!t)throw new ea.ErrnoError(8);return t},get64:function(e,t){return e}},eu={};function ec(){if(!ec.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:k||"./this.program"};for(var t in eu)e[t]=eu[t];var r=[];for(var t in e)r.push(t+"="+e[t]);ec.strings=r}return ec.strings}var ef=function(e,t,r,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=ea.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=n};function el(e,t,r){var n=Array(r>0?r:O(e)+1),o=j(e,n,0,n.length);return t&&(n.length=o),n}Object.defineProperties(ef.prototype,{read:{get:function(){return(365&this.mode)==365},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return(146&this.mode)==146},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return ea.isDir(this.mode)}},isDevice:{get:function(){return ea.isChrdev(this.mode)}}}),ea.FSNode=ef,ea.staticInit();var ed={a:function(e,t,r,n){Y("Assertion failed: "+B(e)+", at: "+[t?B(t):"unknown filename",r,n?B(n):"unknown function"])},s:function(e,t){var r;if(0===e)r=Date.now();else{if(1!==e&&4!==e)return et(28),-1;r=g()}return m[t>>2]=r/1e3|0,m[t+4>>2]=r%1e3*1e6|0,0},d:function(e,t,r){es.varargs=r;try{var n=es.getStreamFromFD(e);switch(t){case 0:var o=es.get();if(o<0)return -28;return ea.open(n.path,n.flags,0,o).fd;case 1:case 2:case 13:case 14:return 0;case 3:return n.flags;case 4:var o=es.get();return n.flags|=o,0;case 12:var o=es.get();return h[o+0>>1]=2,0;case 16:case 8:default:return -28;case 9:return et(28),-1}}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),-e.errno}},i:function(e,t,r){es.varargs=r;try{var n=es.getStreamFromFD(e);switch(t){case 21509:case 21505:case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:case 21523:case 21524:if(!n.tty)return -59;return 0;case 21519:if(!n.tty)return -59;var o=es.get();return m[o>>2]=0,0;case 21520:if(!n.tty)return -59;return -28;case 21531:var o=es.get();return ea.ioctl(n,t,o);default:Y("bad ioctl syscall "+t)}}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),-e.errno}},e:function(e,t,r){es.varargs=r;try{var n=es.getStr(e),o=es.get();return ea.open(n,t,o).fd}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),-e.errno}},t:function(e){try{return e=es.getStr(e),ea.rmdir(e),0}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),-e.errno}},j:function(e){try{var t=es.umask;return es.umask=e,t}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),-e.errno}},u:function(e){try{return e=es.getStr(e),ea.unlink(e),0}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),-e.errno}},v:function(e,t,r,n){try{Y("cannot wait on child processes")}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),-e.errno}},n:function(e,t,r){d.copyWithin(e,t,t+r)},b:function(e){e>>>=0;var t=d.length;if(e>0x80000000)return!1;for(var r=1;r<=4;r*=2){var n,o=t*(1+.2/r);if(o=Math.min(o,e+0x6000000),function(e){try{return c.grow(e-f.byteLength+65535>>>16),L(c.buffer),1}catch(e){}}(Math.min(0x80000000,((n=Math.max(0x1000000,e,o))%65536>0&&(n+=65536-n%65536),n))))return!0}return!1},p:function(e,t){var r=0;return ec().forEach(function(n,o){var i=t+r;m[e+4*o>>2]=i;for(var a=i,s=0;s<n.length;++s)l[0|a++]=n.charCodeAt(s);l[0|a]=0,r+=n.length+1}),0},q:function(e,t){var r=ec();m[e>>2]=r.length;var n=0;return r.forEach(function(e){n+=e.length+1}),m[t>>2]=n,0},c:function(e){ey(e)},f:function(e){try{var t=es.getStreamFromFD(e);return ea.close(t),0}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),e.errno}},r:function(e,t){try{var r=es.getStreamFromFD(e),n=r.tty?2:ea.isDir(r.mode)?3:ea.isLink(r.mode)?7:4;return l[0|t]=n,0}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),e.errno}},h:function(e,t,r,n){try{var o=es.getStreamFromFD(e),i=es.doReadv(o,t,r);return m[n>>2]=i,0}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),e.errno}},m:function(e,t,r,n,o){try{var i=es.getStreamFromFD(e),a=0x100000000*r+(t>>>0);if(a<=-0x20000000000000||a>=0x20000000000000)return -61;return ea.llseek(i,a,n),w=[i.position>>>0,(p=i.position,+W(p)>=1?p>0?X(+$(p/0x100000000),0xffffffff)>>>0:~~q((p-(~~p>>>0))/0x100000000)>>>0:0)],m[o>>2]=w[0],m[o+4>>2]=w[1],i.getdents&&0===a&&0===n&&(i.getdents=null),0}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),e.errno}},g:function(e,t,r,n){try{var o=es.getStreamFromFD(e),i=es.doWritev(o,t,r);return m[n>>2]=i,0}catch(e){return void 0!==ea&&e instanceof ea.ErrnoError||Y(e),e.errno}},memory:c,o:function(){R("missing function: popen"),Y(-1)},l:function(){return 6},k:function(){},table:P};!function(){var e={a:ed};function t(e,t){y.asm=e.exports,Q()}function r(e){t(e.instance)}function n(t){return(!a&&"function"==typeof fetch&&!J(i)?fetch(i,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+i+"'";return e.arrayBuffer()}).catch(function(){return ee()}):new Promise(function(e,t){e(ee())})).then(function(t){return WebAssembly.instantiate(t,e)}).then(t,function(e){R("failed to asynchronously prepare wasm: "+e),Y(e)})}if(K(),y.instantiateWasm)try{return y.instantiateWasm(e,t)}catch(e){return R("Module.instantiateWasm callback failed with error: "+e),!1}!function(){if(a||"function"!=typeof WebAssembly.instantiateStreaming||Z(i,"data:application/octet-stream;base64,")||J(i)||"function"!=typeof fetch)return n(r);fetch(i,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,e).then(r,function(e){return R("wasm streaming compile failed: "+e),R("falling back to ArrayBuffer instantiation"),n(r)})})}()}();var eh=y.___wasm_call_ctors=function(){return(eh=y.___wasm_call_ctors=y.asm.w).apply(null,arguments)},em=y._malloc=function(){return(em=y._malloc=y.asm.x).apply(null,arguments)},ep=y.___errno_location=function(){return(ep=y.___errno_location=y.asm.y).apply(null,arguments)};y._main=function(){return(y._main=y.asm.z).apply(null,arguments)};var ew=y.stackAlloc=function(){return(ew=y.stackAlloc=y.asm.A).apply(null,arguments)};function eg(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ev(e){if(e=e||b,!(G>0)){if(y.preRun)for("function"==typeof y.preRun&&(y.preRun=[y.preRun]);y.preRun.length;){var r;r=y.preRun.shift(),I.unshift(r)}z(I),G>0||(y.setStatus?(y.setStatus("Running..."),setTimeout(function(){setTimeout(function(){y.setStatus("")},1),n()},1)):n())}function n(){if(!v&&(v=!0,y.calledRun=!0,!A)){if(y.noFSInit||ea.init.initialized||ea.init(),z(N),ea.ignorePermissions=!1,z(U),t(y),y.onRuntimeInitialized&&y.onRuntimeInitialized(),eE&&function(e){var t,r=y._main;e=e||[];try{for(let n=0;n<e.length;n++){let o=e[n].split(" ").filter(e=>!!e),{argc:i,argv:a}=function(e){var t=e.length+1,r=ew((t+1)*4);m[r>>2]=T(k);for(var n=1;n<t;n++)m[(r>>2)+n]=T(e[n-1]);return m[(r>>2)+t]=0,{argc:t,argv:r}}(o);if(t=r(i,a),0!==t)break}ey(t,!0)}catch(e){if(e instanceof eg)return;if("unwind"==e){u=!0;return}var n=e;e&&"object"==typeof e&&e.stack&&(n=[e,e.stack]),R("exception thrown: "+n),_(1,e)}finally{}}(e),y.postRun)for("function"==typeof y.postRun&&(y.postRun=[y.postRun]);y.postRun.length;){var r;r=y.postRun.shift(),H.unshift(r)}z(H)}}}function ey(e,t){t&&u&&0===e||(u||(A=!0,y.onExit&&y.onExit(e)),_(e,new eg(e)))}if(y.dynCall_vi=function(){return(y.dynCall_vi=y.asm.B).apply(null,arguments)},V=function e(){v||ev(),v||(V=e)},y.run=ev,y.preInit)for("function"==typeof y.preInit&&(y.preInit=[y.preInit]);y.preInit.length>0;)y.preInit.pop()();var eE=!0;return y.noInitialRun&&(eE=!1),u=!0,ev(),e.ready},t="",r="",c=()=>{t.length>0&&(console.log(t),t=""),r.length>0&&(console.error(r),r="")},f=e=>{t+=String.fromCharCode(e),10===e&&(console.log(t),t="")},n=[],async(e={})=>{let{data:t=null,command:r=[],folder:o=[],isStrict:i=!1}=e;return await new Promise(e=>{n.push(e),1===n.length&&n[0]()}),new Promise((e,a)=>{let s=!1,l="";u({stdout:f,stderr:e=>{l+=String.fromCharCode(e),10===e&&(console.error(l),i&&a(l))},arguments:r,input:t,folder:o,output:t=>{e(t),s=!0}}).then(()=>{c(),s||a(),n.length>0&&(n.shift(),n.length>0&&n[0]())})})});var s,u,c,f,l=e.i(549186);class d extends l.ImageBase{async compress(){try{let{width:e,height:t,x:r,y:n}=this.getOutputDimension(),o=["--optimize=3",`--colors=${this.option.gif.colors}`];e!==this.info.width||t!==this.info.height?o.push(`--crop=${r},${n}+${e}x${t}`):o.push(`--resize=${e}x${t}`),this.option.gif.dithering&&o.push("--dither=floyd-steinberg"),o.push(`--output=/out/${this.info.name}`),o.push(this.info.name);let i=await this.info.blob.arrayBuffer(),s=await a({data:[{file:i,name:this.info.name}],command:[o.join(" ")]});if(!Array.isArray(s)||1!==s.length)return this.failResult();let u=new Blob([s[0].file],{type:this.info.blob.type});return{width:e,height:t,blob:u,src:URL.createObjectURL(u)}}catch(e){return this.failResult()}}async preview(){let{width:e,height:t,x:r,y:n}=this.getPreviewDimension(),o=[`--colors=${this.option.gif.colors}`,`--output=/out/${this.info.name}`];e!==this.info.width||t!==this.info.height?o.push(`--crop=${r},${n}+${e}x${t}`):o.push(`--resize=${e}x${t}`),o.push(this.info.name);let i=await this.info.blob.arrayBuffer(),s=await a({data:[{file:i,name:this.info.name}],command:[o.join(" ")]});if(!Array.isArray(s)||1!==s.length)return{width:this.info.width,height:this.info.height,blob:this.info.blob,src:URL.createObjectURL(this.info.blob)};let u=new Blob([s[0].file],{type:this.info.blob.type});return{width:e,height:t,blob:u,src:URL.createObjectURL(u)}}}var h=l,m=e.i(930114);class p extends h.ImageBase{async compress(){let{width:e,height:t,x:r,y:n}=this.getOutputDimension(),{context:o}=await this.createCanvas(e,t,r,n),i=o.getImageData(0,0,e,t).data;try{let r=m.Module._malloc(i.byteLength);m.Module.HEAPU8.set(i,r);let n=e*t*4;if(i.byteLength!==n)return this.failResult();let o=m.Module._malloc(4);if(m.Module._compress(e,t,this.option.png.colors,this.option.png.dithering,r,o))return this.failResult();let a=m.Module.getValue(o,"i32",!1),s=new Uint8Array(a);s.set(m.Module.HEAPU8.subarray(r,r+a)),m.Module._free(r),m.Module._free(o);let u=new Blob([s],{type:this.info.blob.type});return{width:e,height:t,blob:u,src:URL.createObjectURL(u)}}catch(e){return this.failResult()}}}var w=e.i(20966),g=l,v=e.i(175604);class y extends g.ImageBase{static async encode(e,t,r,n={}){let o=e.getImageData(0,0,t,r);return new Blob([await (0,v.default)(o,n)],{type:w.Mimes.jpeg})}async compress(){let{width:e,height:t,x:r,y:n}=this.getOutputDimension();try{let{context:o}=await this.createCanvas(e,t,r,n),i=await y.encode(o,e,t,this.option.jpeg);return{width:e,height:t,blob:i,src:URL.createObjectURL(i)}}catch(e){return this.failResult()}}}var E=e.i(501764),b=l,k=e.i(126479);class _ extends b.ImageBase{static async encode(e,t,r,n={}){let o=e.getImageData(0,0,t,r);return new Blob([await (0,k.default)(o,n)],{type:w.Mimes.webp})}async compress(){let{width:e,height:t,x:r,y:n}=this.getOutputDimension();try{let{context:o}=await this.createCanvas(e,t,r,n),i=await _.encode(o,e,t,this.option.webp);return{width:e,height:t,blob:i,src:URL.createObjectURL(i)}}catch(e){return this.failResult()}}}var D=l,x=e.i(4436),S=e.i(930733);class R extends D.ImageBase{decodedImageData=null;constructor(e,t,r){super(e,t),r?(this.decodedImageData=r,this.info.width=r.width,this.info.height=r.height):this.initialize()}async initialize(){if(!this.decodedImageData&&"image/jxl"===this.info.blob.type)try{this.decodedImageData=await (0,S.default)(this.info.blob),this.info.width=this.decodedImageData.width,this.info.height=this.decodedImageData.height}catch(e){this.decodedImageData=null}}static async encode(e,t,r,n={}){let o=e.getImageData(0,0,t,r);return new Blob([await (0,x.default)(o,n)],{type:w.Mimes.jxl})}async compress(){let{width:e,height:t,x:r,y:n}=this.getOutputDimension();try{let{context:o}=await this.createCanvas(e,t,r,n),i=await R.encode(o,e,t,this.option.jxl);return{width:e,height:t,blob:i,src:URL.createObjectURL(i)}}catch(e){return this.failResult()}}}var P=l;class A extends P.ImageBase{async compress(){if(0===this.info.width||0===this.info.height)return this.failResult();let e=new Blob([(await this.info.blob.text()).replace(/<!--[\s\S]*?-->/g,"").replace(/>\s+</g,"><").replace(/\s+/g," ").trim()],{type:w.Mimes.svg});return{width:this.info.width,height:this.info.height,blob:e,src:URL.createObjectURL(e)}}async preview(){return this.failResult()}}let M=/\sheight=(['"])([^%]+?)\1/,F=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,B=/\sviewBox=(['"])(.+?)\1/i,j=/\swidth=(['"])([^%]+?)\1/,O={in:96,cm:37.79527559055118,em:16,ex:8,m:37.79527559055118*100,mm:37.79527559055118/10,pc:96/72/12,pt:96/72,px:1},T=RegExp(`^([0-9.]+(?:e\\d+)?)(${Object.keys(O).join("|")})?$`);function L(e){let t=T.exec(e);if(t)return Math.round(Number(t[1])*(O[t[2]]||1))}async function C(e,t="compress"){let r=e.info.blob.type.toLowerCase();if(w.Mimes.svg===r){if(e.info.width>0&&e.info.height>0)return z(e,t);let r=await e.info.blob.text(),n={width:0,height:0};try{n=function(e){let t=e.match(F);if(t){var r,n;let e,o,i,a,s=(o=(n=t[0]).match(j),i=n.match(M),a=n.match(B),{height:i&&L(i[2]),viewbox:a&&(e=a[2].split(" "),{height:L(e[3]),width:L(e[2])}),width:o&&L(o[2])});if(s.width&&s.height)return{x:0,y:0,height:s.height,width:s.width};if(s.viewbox){let e;return e=(r=s.viewbox).width/r.height,s.width?{x:0,y:0,height:Math.floor(s.width/e),width:s.width}:s.height?{x:0,y:0,height:s.height,width:Math.floor(s.height*e)}:{x:0,y:0,height:r.height,width:r.width}}}throw TypeError("Invalid SVG")}(r)}catch(e){}return e.info.width=n.width,e.info.height=n.height,z(e,t)}let n=null,o=null;if(e.info.blob.type===w.Mimes.jxl?(o=await (0,S.default)(e.info.blob),e.info.width=o.width,e.info.height=o.height):(n=await createImageBitmap(e.info.blob),e.info.width=n.width,e.info.height=n.height),"compress"===t&&e.option.format.target&&e.option.format.target!==e.info.blob.type){let r=e.option.format.target.toLowerCase();if("avif"===r)return z(e,t,w.Mimes.avif);if(["jpg","jpeg"].includes(r))return z(e,t,w.Mimes.jpeg);if("webp"===r)return z(e,t,w.Mimes.webp);if("jxl"===r)return z(e,t,w.Mimes.jxl,o);let i=new OffscreenCanvas(n.width,n.height),a=i.getContext("2d");["jpg","jpeg"].includes(r)&&(a.fillStyle=e.option.format.transparentFill,a.fillRect(0,0,n.width,n.height)),a.drawImage(n,0,0,n.width,n.height,0,0,n.width,n.height),e.info.blob=await i.convertToBlob({type:w.Mimes[r],quality:1})}return n&&n.close(),z(e,t,void 0,o)}async function z(e,t,r,n){let o=e.info.blob.type.toLowerCase();r&&(o=r);let i=null;if([w.Mimes.webp].includes(o)?i=new _(e.info,e.option):o===w.Mimes.avif?i=new E.AvifImage(e.info,e.option):o===w.Mimes.jpeg||o===w.Mimes.jpg?i=new y(e.info,e.option):o===w.Mimes.jxl?i=new R(e.info,e.option,n):o===w.Mimes.png?i=new p(e.info,e.option):o===w.Mimes.gif?i=new d(e.info,e.option):o===w.Mimes.svg&&(i=new A(e.info,e.option)),!i)return null;let a={key:i.info.key,width:i.info.width,height:i.info.height};return i&&"preview"===t?(a.preview=await i.preview(),a):i&&"compress"===t?(a.compress=await i.compress(),a):null}e.s(["convert",()=>C],362197);let I="image/avif";async function N(){let e=new OffscreenCanvas(1,1);e.getContext("2d");try{return await e.convertToBlob({type:I}),!0}catch(e){return!1}}async function U(){await N()&&(w.Mimes.avif=I)}e.s(["avifCheck",()=>U],673468)}]);