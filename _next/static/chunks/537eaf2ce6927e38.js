(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,195883,e=>{"use strict";var t=e.i(843476);function r({children:e,gap:r="0",alignment:n="start",distribution:a="start",className:i="",style:s,width:o="100"}){let l=["d-flex flex-column","25"===o?"w-25":"50"===o?"w-50":"75"===o?"w-75":"100"===o?"w-100":"auto"===o?"w-auto":"",`gap-${r}`,`align-items-${n}`,`justify-content-${"between"===a?"between":"around"===a?"around":"evenly"===a?"evenly":a}`,i].filter(Boolean).join(" "),c={...s,..."string"==typeof o&&!["25","50","75","100","auto"].includes(o)?{width:o}:{}};return(0,t.jsx)("div",{className:l,style:c,children:e})}e.s(["default",()=>r])},958155,e=>{"use strict";var t=e.i(843476),r=e.i(195883);function n({children:e,style:n}){return(0,t.jsx)(r.default,{gap:"3",alignment:"start",className:"px-3 pb-3",style:n,children:e})}e.s(["default",()=>n])},701870,e=>{"use strict";async function t(e,t,r){return e({...r,locateFile:e=>e.endsWith(".wasm")?new URL(e,location.origin).toString():e,...t?{wasmModule:t}:{}})}function r(e,t){return console.time(e),t().finally(()=>console.timeEnd(e))}async function n(e,t){if(e.aborted)throw new DOMException("AbortError","AbortError");return Promise.race([t,new Promise((t,r)=>{e.addEventListener("abort",()=>r(new DOMException("AbortError","AbortError")))})])}e.s(["abortable",()=>n,"initEmscriptenModule",()=>t,"timed",()=>r],701870)},102579,e=>{e.v("/_next/static/media/imageWorker.517c6678.ts")},255519,e=>{"use strict";let t=Symbol("Comlink.proxy"),r=Symbol("Comlink.endpoint"),n=Symbol("Comlink.releaseProxy"),a=Symbol("Comlink.finalizer"),i=Symbol("Comlink.thrown"),s=e=>"object"==typeof e&&null!==e||"function"==typeof e,o=new Map([["proxy",{canHandle:e=>s(e)&&e[t],serialize(e){let{port1:t,port2:r}=new MessageChannel;return l(e,t),[r,[r]]},deserialize:e=>(e.start(),u(e))}],["throw",{canHandle:e=>s(e)&&i in e,serialize:({value:e})=>[e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[]],deserialize(e){if(e.isError)throw Object.assign(Error(e.value.message),e.value);throw e.value}}]]);function l(e,r=globalThis,n=["*"]){r.addEventListener("message",function s(o){let u;if(!o||!o.data)return;if(!function(e,t){for(let r of e)if(t===r||"*"===r||r instanceof RegExp&&r.test(t))return!0;return!1}(n,o.origin))return void console.warn(`Invalid origin '${o.origin}' for comlink proxy`);let{id:d,type:m,path:h}=Object.assign({path:[]},o.data),g=(o.data.argumentList||[]).map(w);try{var f,y,x;let r=h.slice(0,-1).reduce((e,t)=>e[t],e),n=h.reduce((e,t)=>e[t],e);switch(m){case"GET":u=n;break;case"SET":r[h.slice(-1)[0]]=w(o.data.value),u=!0;break;case"APPLY":u=n.apply(r,g);break;case"CONSTRUCT":f=new n(...g),u=Object.assign(f,{[t]:!0});break;case"ENDPOINT":{let{port1:t,port2:r}=new MessageChannel;l(e,r),y=t,x=[t],p.set(y,x),u=y}break;case"RELEASE":u=void 0;break;default:return}}catch(e){u={value:e,[i]:0}}Promise.resolve(u).catch(e=>({value:e,[i]:0})).then(t=>{let[n,i]=b(t);r.postMessage(Object.assign(Object.assign({},n),{id:d}),i),"RELEASE"===m&&(r.removeEventListener("message",s),c(r),a in e&&"function"==typeof e[a]&&e[a]())}).catch(e=>{let[t,n]=b({value:TypeError("Unserializable return value"),[i]:0});r.postMessage(Object.assign(Object.assign({},t),{id:d}),n)})}),r.start&&r.start()}function c(e){"MessagePort"===e.constructor.name&&e.close()}function u(e,t){let a=new Map;return e.addEventListener("message",function(e){let{data:t}=e;if(!t||!t.id)return;let r=a.get(t.id);if(r)try{r(t)}finally{a.delete(t.id)}}),function e(t,a,i=[],s=function(){}){let o,l=!1,c=new Proxy(s,{get(r,s){if(d(l),s===n)return()=>{g&&g.unregister(c),m(t),a.clear(),l=!0};if("then"===s){if(0===i.length)return{then:()=>c};let e=y(t,a,{type:"GET",path:i.map(e=>e.toString())}).then(w);return e.then.bind(e)}return e(t,a,[...i,s])},set(e,r,n){d(l);let[s,o]=b(n);return y(t,a,{type:"SET",path:[...i,r].map(e=>e.toString()),value:s},o).then(w)},apply(n,s,o){d(l);let c=i[i.length-1];if(c===r)return y(t,a,{type:"ENDPOINT"}).then(w);if("bind"===c)return e(t,a,i.slice(0,-1));let[u,m]=f(o);return y(t,a,{type:"APPLY",path:i.map(e=>e.toString()),argumentList:u},m).then(w)},construct(e,r){d(l);let[n,s]=f(r);return y(t,a,{type:"CONSTRUCT",path:i.map(e=>e.toString()),argumentList:n},s).then(w)}});return o=(h.get(t)||0)+1,h.set(t,o),g&&g.register(c,t,c),c}(e,a,[],t)}function d(e){if(e)throw Error("Proxy has been released and is not useable")}function m(e){return y(e,new Map,{type:"RELEASE"}).then(()=>{c(e)})}let h=new WeakMap,g="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(h.get(e)||0)-1;h.set(e,t),0===t&&m(e)});function f(e){var t;let r=e.map(b);return[r.map(e=>e[0]),(t=r.map(e=>e[1]),Array.prototype.concat.apply([],t))]}let p=new WeakMap;function b(e){for(let[t,r]of o)if(r.canHandle(e)){let[n,a]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},a]}return[{type:"RAW",value:e},p.get(e)||[]]}function w(e){switch(e.type){case"HANDLER":return o.get(e.name).deserialize(e.value);case"RAW":return e.value}}function y(e,t,r,n){return new Promise(a=>{let i=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(i,a),e.start&&e.start(),e.postMessage(Object.assign({id:i},r),n)})}e.s(["expose",()=>l,"wrap",()=>u])},469214,e=>{e.v(e.b(["static/chunks/2a3ef0d1c7438f82.js","static/chunks/turbopack-4146a3068f4467ba.js"]))},653728,e=>{"use strict";var t=e.i(843476),r=e.i(958155),n=e.i(271645),a=e.i(255519),i=e.i(701870);class s{_queue=Promise.resolve();_worker;_workerApi;_workerTimeout;_terminateWorker(){this._worker&&(this._worker.terminate(),this._worker=void 0,this._workerApi=void 0)}_startWorker(){this._worker=new Worker(e.r(469214),{type:"module",type:void 0}),this._workerApi=a.wrap(this._worker)}}for(let e of["avifEncode"])s.prototype[e]=function(t,...r){return this._queue=this._queue.catch(()=>{}).then(async()=>{if(t.aborted)throw new DOMException("AbortError","AbortError");clearTimeout(this._workerTimeout),this._worker||this._startWorker();let n=()=>this._terminateWorker();return t.addEventListener("abort",n),(0,i.abortable)(t,this._workerApi[e](...r)).finally(()=>{t.removeEventListener("abort",n),this._workerTimeout=setTimeout(()=>{this._terminateWorker()},1e4)})}),this._queue};let o=new s;function l(){let[e,a]=(0,n.useState)("Ready"),[i,s]=(0,n.useState)(null),[l,c]=(0,n.useState)(0),[u,d]=(0,n.useState)(0),m=async e=>{let t=e.target.files?.[0];if(!t)return;a("Loading image..."),s(null);let r=new AbortController,n=new Image,i=URL.createObjectURL(t);n.src=i,await new Promise(e=>n.onload=e);let l=document.createElement("canvas");l.width=n.width,l.height=n.height;let u=l.getContext("2d");u.drawImage(n,0,0);let m=u.getImageData(0,0,n.width,n.height);c(t.size),a("Encoding with AVIF... (background worker)");try{let e=await o.avifEncode(r.signal,m,{quality:65,speed:8,subsample:2}),n=new Blob([e],{type:"image/avif"}),i=URL.createObjectURL(n);console.log("Encoding complete: ",i),s(i),d(e.byteLength),a(`Success! Reduced by ${((1-e.byteLength/t.size)*100).toFixed(1)}%`)}catch(e){a(`Error: ${e.message||e}`)}URL.revokeObjectURL(i)};return(0,t.jsx)(r.default,{children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-12",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold mb-8",children:"Squoosh-Style Image Processor"}),(0,t.jsx)("p",{className:"text-lg text-gray-600 mb-10",children:"Uses a shared Web Worker with idle timeout and full AbortSignal support"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:m,className:"block w-full text-lg file:mr-4 file:py-3 file:px-6 file:rounded-lg file:border-0 file:bg-blue-600 file:text-white hover:file:bg-blue-700"}),(0,t.jsx)("p",{className:"mt-8 text-xl font-medium",children:e}),i&&(0,t.jsxs)("div",{className:"mt-12 grid md:grid-cols-2 gap-12 items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold",children:"Original"}),(0,t.jsxs)("p",{className:"text-gray-600",children:[(l/1024).toFixed(1)," KB"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-green-600",children:"AVIF Result"}),(0,t.jsx)("a",{href:i,download:"converted.avif",className:"mt-6 inline-block px-8 py-4 bg-green-600 rounded-lg hover:bg-green-700",children:"Download AVIF"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-4",children:[(u/1024).toFixed(1)," KB"]}),(0,t.jsx)("img",{src:i,alt:"AVIF output",className:"rounded-xl shadow-2xl border max-w-full"})]})]})]})})}e.s(["default",()=>l],653728)}]);