(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,102579,e=>{e.v("/_next/static/media/imageWorker.3dd186a3.ts")},701870,486415,e=>{"use strict";let t=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]));async function n(e,t,n){return e({...n,locateFile:e=>e.endsWith(".wasm")?new URL(e,location.origin).toString():e,...t?{wasmModule:t}:{}})}function r(e,t){return console.time(e),t().finally(()=>console.timeEnd(e))}async function a(e,t){if(e.aborted)throw new DOMException("AbortError","AbortError");return Promise.race([t,new Promise((t,n)=>{e.addEventListener("abort",()=>n(new DOMException("AbortError","AbortError")))})])}e.s(["simd",0,t,"threads",0,()=>(async e=>{try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))],486415),e.s(["abortable",()=>a,"initEmscriptenModule",()=>n,"timed",()=>r],701870)},255519,e=>{"use strict";let t=Symbol("Comlink.proxy"),n=Symbol("Comlink.endpoint"),r=Symbol("Comlink.releaseProxy"),a=Symbol("Comlink.finalizer"),i=Symbol("Comlink.thrown"),s=e=>"object"==typeof e&&null!==e||"function"==typeof e,l=new Map([["proxy",{canHandle:e=>s(e)&&e[t],serialize(e){let{port1:t,port2:n}=new MessageChannel;return o(e,t),[n,[n]]},deserialize:e=>(e.start(),d(e))}],["throw",{canHandle:e=>s(e)&&i in e,serialize:({value:e})=>[e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[]],deserialize(e){if(e.isError)throw Object.assign(Error(e.value.message),e.value);throw e.value}}]]);function o(e,t=globalThis,n=["*"]){t.addEventListener("message",function r(s){let l;if(!s||!s.data)return;if(!function(e,t){for(let n of e)if(t===n||"*"===n||n instanceof RegExp&&n.test(t))return!0;return!1}(n,s.origin))return void console.warn(`Invalid origin '${s.origin}' for comlink proxy`);let{id:d,type:b,path:m}=Object.assign({path:[]},s.data),u=(s.data.argumentList||[]).map(w);try{let t=m.slice(0,-1).reduce((e,t)=>e[t],e),n=m.reduce((e,t)=>e[t],e);switch(b){case"GET":l=n;break;case"SET":t[m.slice(-1)[0]]=w(s.data.value),l=!0;break;case"APPLY":l=n.apply(t,u);break;case"CONSTRUCT":{let e=new n(...u);l=f(e)}break;case"ENDPOINT":{var h,p;let{port1:t,port2:n}=new MessageChannel;o(e,n),h=t,p=[t],g.set(h,p),l=h}break;case"RELEASE":l=void 0;break;default:return}}catch(e){l={value:e,[i]:0}}Promise.resolve(l).catch(e=>({value:e,[i]:0})).then(n=>{let[i,s]=x(n);t.postMessage(Object.assign(Object.assign({},i),{id:d}),s),"RELEASE"===b&&(t.removeEventListener("message",r),c(t),a in e&&"function"==typeof e[a]&&e[a]())}).catch(e=>{let[n,r]=x({value:TypeError("Unserializable return value"),[i]:0});t.postMessage(Object.assign(Object.assign({},n),{id:d}),r)})}),t.start&&t.start()}function c(e){"MessagePort"===e.constructor.name&&e.close()}function d(e,t){let a=new Map;return e.addEventListener("message",function(e){let{data:t}=e;if(!t||!t.id)return;let n=a.get(t.id);if(n)try{n(t)}finally{a.delete(t.id)}}),function e(t,a,i=[],s=function(){}){let l,o=!1,c=new Proxy(s,{get(n,s){if(b(o),s===r)return()=>{h&&h.unregister(c),m(t),a.clear(),o=!0};if("then"===s){if(0===i.length)return{then:()=>c};let e=y(t,a,{type:"GET",path:i.map(e=>e.toString())}).then(w);return e.then.bind(e)}return e(t,a,[...i,s])},set(e,n,r){b(o);let[s,l]=x(r);return y(t,a,{type:"SET",path:[...i,n].map(e=>e.toString()),value:s},l).then(w)},apply(r,s,l){b(o);let c=i[i.length-1];if(c===n)return y(t,a,{type:"ENDPOINT"}).then(w);if("bind"===c)return e(t,a,i.slice(0,-1));let[d,m]=p(l);return y(t,a,{type:"APPLY",path:i.map(e=>e.toString()),argumentList:d},m).then(w)},construct(e,n){b(o);let[r,s]=p(n);return y(t,a,{type:"CONSTRUCT",path:i.map(e=>e.toString()),argumentList:r},s).then(w)}});return l=(u.get(t)||0)+1,u.set(t,l),h&&h.register(c,t,c),c}(e,a,[],t)}function b(e){if(e)throw Error("Proxy has been released and is not useable")}function m(e){return y(e,new Map,{type:"RELEASE"}).then(()=>{c(e)})}let u=new WeakMap,h="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(u.get(e)||0)-1;u.set(e,t),0===t&&m(e)});function p(e){var t;let n=e.map(x);return[n.map(e=>e[0]),(t=n.map(e=>e[1]),Array.prototype.concat.apply([],t))]}let g=new WeakMap;function f(e){return Object.assign(e,{[t]:!0})}function x(e){for(let[t,n]of l)if(n.canHandle(e)){let[r,a]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},a]}return[{type:"RAW",value:e},g.get(e)||[]]}function w(e){switch(e.type){case"HANDLER":return l.get(e.name).deserialize(e.value);case"RAW":return e.value}}function y(e,t,n,r){return new Promise(a=>{let i=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(i,a),e.start&&e.start(),e.postMessage(Object.assign({id:i},n),r)})}e.s(["expose",()=>o,"proxy",()=>f,"wrap",()=>d])},469214,e=>{e.v(e.b(["static/chunks/5bf708b364f37838.js","static/chunks/85c3e68071930455.js","static/chunks/turbopack-1ee8436f7d4d0b91.js"]))},570766,e=>{"use strict";var t=e.i(255519),n=e.i(701870);class r{_queue=Promise.resolve();_worker;_workerApi;_workerTimeout;_terminateWorker(){this._worker&&(this._worker.terminate(),this._worker=void 0,this._workerApi=void 0)}_startWorker(){this._worker=new Worker(e.r(469214),{type:"module",type:void 0}),this._workerApi=t.wrap(this._worker)}}for(let e of["avifEncode","webpEncode","jxlEncode","avifDecode","webpDecode","mozjpegEncode","jxlDecode","qoiEncode","resize","quantize","rotate","flipHorizontal","flipVertical","grayscale","sepia","sharpen","gaussianBlur","brightness","contrast","hueRotate","watermark","filter","blendOver","blendOverlay","blendAtop","blendPlus","blendMultiply","blendBurn","blendDifference","blendSoftLight","blendHardLight","blendDodge","blendExclusion","blendLighten","blendDarken","pixelateBlur"])r.prototype[e]=function(t,...r){return this._queue=this._queue.catch(()=>{}).then(async()=>{if(t.aborted)throw new DOMException("AbortError","AbortError");clearTimeout(this._workerTimeout),this._worker||this._startWorker();let a=()=>this._terminateWorker();return t.addEventListener("abort",a),(0,n.abortable)(t,this._workerApi[e](...r)).finally(()=>{t.removeEventListener("abort",a),this._workerTimeout=setTimeout(()=>{this._terminateWorker()},1e4)})}),this._queue};let a=new r;e.s(["processor",0,a],570766)},896835,e=>{e.v("/_next/static/media/mediaWorker.f65923fc.ts")},399229,e=>{e.v(e.b(["static/chunks/774ff5bf0523a39f.js","static/chunks/turbopack-49b8c1ee63258232.js"]))},654534,e=>{"use strict";var t=e.i(255519),n=e.i(701870);class r{_queue=Promise.resolve();_worker;_workerApi;_workerTimeout;_terminateWorker(){this._worker&&(this._worker.terminate(),this._worker=void 0,this._workerApi=void 0,void 0!==this._workerTimeout&&(clearTimeout(this._workerTimeout),this._workerTimeout=void 0))}_startWorker(){this._worker=new Worker(e.r(399229),{type:"module",type:void 0}),this._workerApi=t.wrap(this._worker)}}for(let e of["encodeToMp4","encodeToGif"])r.prototype[e]=function(...r){let a,i,s;return r.length>0&&r[0]instanceof AbortSignal?(a=r[0],i=r.slice(1)):(a=void 0,i=r),i.length>0&&"function"==typeof i[i.length-1]&&(s=i.pop()),a||(a=new AbortController().signal),this._queue=this._queue.catch(()=>{}).then(async()=>{if(a.aborted)throw new DOMException("Aborted","AbortError");void 0!==this._workerTimeout&&clearTimeout(this._workerTimeout),this._worker||this._startWorker();let r=()=>this._terminateWorker();a.addEventListener("abort",r,{once:!0});try{let r;return s&&(r=t.proxy(s)),await (0,n.abortable)(a,this._workerApi[e](...i,r))}finally{a.removeEventListener("abort",r),this._workerTimeout=self.setTimeout(()=>{this._terminateWorker()},3e4)}}),this._queue};let a=new r;e.s(["mediaProcessor",0,a],654534)},63524,e=>{"use strict";var t=e.i(843476),n=e.i(271645),r=e.i(570766),a=e.i(654534);function i(){let e=(0,n.useRef)(null),i=(0,n.useRef)(null),s=(0,n.useRef)(null),[l,o]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[b,m]=(0,n.useState)(null),[u,h]=(0,n.useState)(null),[p,g]=(0,n.useState)(!1),[f,x]=(0,n.useState)(null),[w,y]=(0,n.useState)(0),[v,k]=(0,n.useState)(0),[j,N]=(0,n.useState)(0),[C,E]=(0,n.useState)(0),[S,_]=(0,n.useState)(0),[R,$]=(0,n.useState)(null),[L,A]=(0,n.useState)(null),[T,M]=(0,n.useState)({grayscale:!1,sepia:!1,sharpen:!1,flipHorizontal:!1,flipVertical:!1}),[O,P]=(0,n.useState)({enabled:!1,text:"Test Water Mark 2025",size:120,color:"#ffffff",opacity:.6,position:"bottom-right"}),[z,D]=(0,n.useState)(!1),[U,B]=(0,n.useState)([]),[W]=(0,n.useState)(30),F=(0,n.useRef)(null),[I,H]=(0,n.useState)(null),[q,V]=(0,n.useState)(!1),[G,Y]=(0,n.useState)([]),X=(0,n.useRef)(null),[K,J]=(0,n.useState)(!1),[Q,Z]=(0,n.useState)([]),ee=(0,n.useRef)(null),et=(0,n.useRef)(null),[en,er]=(0,n.useState)(!1),[ea,ei]=(0,n.useState)(null);(0,n.useEffect)(()=>{c&&(async()=>{g(!0);let e=c,t=new AbortController;try{if(T.flipHorizontal&&(e=await r.processor.flipHorizontal(t.signal,e)),T.flipVertical&&(e=await r.processor.flipVertical(t.signal,e)),0!==w&&(e=await r.processor.rotate(t.signal,e,w)),0!==j&&(e=await r.processor.brightness(t.signal,e,j)),0!==C&&(e=await r.processor.contrast(t.signal,e,C)),0!==S&&(e=await r.processor.hueRotate(t.signal,e,S)),R&&(e=await r.processor.filter(t.signal,e,R)),T.grayscale&&(e=await r.processor.grayscale(t.signal,e)),T.sepia&&(e=await r.processor.sepia(t.signal,e)),T.sharpen&&(e=await r.processor.sharpen(t.signal,e)),v>0&&(e=await r.processor.gaussianBlur(t.signal,e,v)),L&&b){let t=`blend_${L}`;"function"==typeof r.processor[t]&&(e=await r.processor[t](e,b))}O.enabled&&O.text.trim()&&(e=await r.processor.watermark(t.signal,e,O.text,{fontSize:O.size,color:O.color,opacity:O.opacity,position:O.position})),h(e)}catch(e){console.error("Processing failed:",e)}finally{g(!1)}})()},[c,b,w,v,j,C,S,R,L,T,O]),(0,n.useEffect)(()=>{if(!u||!e.current)return;let t=e.current;t.width=u.width,t.height=u.height;let n=t.getContext("2d");n&&n.putImageData(u,0,0)},[u]);let es=async()=>{if(0!==U.length)try{let e=await a.mediaProcessor.encodeToMp4(U),t=new Blob([e],{type:"video/mp4"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`canvas-effects-${W}fps-${U.length}-frames.mp4`,r.click(),URL.revokeObjectURL(n),B([])}catch(e){console.error("Canvas video export failed:",e),alert("Failed to encode canvas animation.")}},el=async()=>{try{let e=await navigator.mediaDevices.getDisplayMedia({video:{frameRate:{ideal:30}},audio:!0}),t=[],n=new MediaRecorder(e,{mimeType:"video/webm;codecs=vp9"});n.ondataavailable=e=>{e.data.size>0&&t.push(e.data)},n.onstop=()=>{Y(t),e.getTracks().forEach(e=>e.stop())},n.start(),X.current=n,H(e),V(!0)}catch(e){console.error("Screen recording failed:",e),alert("Screen sharing permission denied.")}},eo=async()=>{if(0!==G.length)try{let e=new Blob(G,{type:"video/webm"}),t=new Uint8Array(await e.arrayBuffer()),n=await a.mediaProcessor.encodeToMp4(t),r=new Blob([n],{type:"video/mp4"}),i=URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=`screen-recording-${new Date().toISOString().slice(0,19)}.mp4`,s.click(),URL.revokeObjectURL(i),Y([])}catch(e){console.error("Screen export failed:",e),alert("Failed to convert to MP4.")}};(0,n.useEffect)(()=>{if(!en||!et.current)return;let e=et.current,t=0,n=0,r=e=>{t=e.clientX,n=e.clientY,ei({x:t,y:n,width:0,height:0})},a=e=>{if(!ea)return;let r=Math.abs(e.clientX-t),a=Math.abs(e.clientY-n);ei({x:Math.min(e.clientX,t),y:Math.min(e.clientY,n),width:r,height:a})},i=async()=>{if(!ea||ea.width<10||ea.height<10){er(!1),ei(null);return}er(!1),await ec(ea)};return e.addEventListener("mousedown",r),e.addEventListener("mousemove",a),e.addEventListener("mouseup",i),()=>{e.removeEventListener("mousedown",r),e.removeEventListener("mousemove",a),e.removeEventListener("mouseup",i)}},[en,ea]);let ec=async e=>{try{let t=await navigator.mediaDevices.getDisplayMedia({video:{frameRate:{ideal:30}},audio:!0}),n=document.createElement("video");n.srcObject=t,await n.play();let r=document.createElement("canvas");r.width=e.width,r.height=e.height;let a=r.getContext("2d");if(!a)throw Error("Canvas context unavailable");let i=[],s=new MediaRecorder(r.captureStream(30),{mimeType:"video/webm;codecs=vp9"});s.ondataavailable=e=>{e.data.size>0&&i.push(e.data)},s.onstop=()=>{Z(i),t.getTracks().forEach(e=>e.stop())};let l=()=>{a.drawImage(n,e.x,e.y,e.width,e.height,0,0,e.width,e.height),"recording"===s.state&&requestAnimationFrame(l)};s.start(),l(),ee.current=s,H(t),J(!0)}catch(e){console.error("Region recording failed:",e),alert("Failed to start region recording.")}},ed=async()=>{if(0!==Q.length)try{let e=new Blob(Q,{type:"video/webm"}),t=new Uint8Array(await e.arrayBuffer()),n=await a.mediaProcessor.encodeToMp4(t),r=new Blob([n],{type:"video/mp4"}),i=URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=`region-recording-${new Date().toISOString().slice(0,19)}.mp4`,s.click(),URL.revokeObjectURL(i),Z([])}catch(e){console.error("Region export failed:",e),alert("Failed to convert region recording.")}};return(0,t.jsxs)("div",{className:"min-vh-100 bg-body",children:[en&&(0,t.jsxs)("div",{ref:et,style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.4)",cursor:"crosshair",zIndex:9999},children:[ea&&(0,t.jsx)("div",{style:{position:"absolute",left:ea.x,top:ea.y,width:ea.width,height:ea.height,border:"2px dashed #ff0000",backgroundColor:"rgba(255,0,0,0.1)"}}),(0,t.jsx)("div",{style:{position:"absolute",top:10,left:10,color:"white",fontSize:"18px"},children:"Drag to select region, then release."})]}),(0,t.jsxs)("div",{className:"container py-5",children:[(0,t.jsxs)("div",{className:"text-center mb-5",children:[(0,t.jsx)("h1",{className:"display-4 fw-bold text-primary mb-3",children:"ImageProcessor + Recorder Demo"}),(0,t.jsx)("p",{className:"lead text-body-secondary",children:"Edit images and record screen with worker-based MP4 encoding"})]}),(0,t.jsxs)("div",{className:"text-center mb-5",children:[(0,t.jsx)("input",{ref:i,type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];if(!t)return;let n=new FileReader;n.onload=e=>{let t=e.target?.result;x(t);let n=new Image;n.onload=()=>{o(n);let e=document.createElement("canvas");e.width=n.width,e.height=n.height;let t=e.getContext("2d");t&&(t.drawImage(n,0,0),d(t.getImageData(0,0,n.width,n.height))),y(0),k(0),N(0),E(0),_(0),$(null),A(null),M({grayscale:!1,sepia:!1,sharpen:!1,flipHorizontal:!1,flipVertical:!1}),P(e=>({...e,enabled:!1})),m(null)},n.src=t},n.readAsDataURL(t)},className:"d-none"}),(0,t.jsx)("input",{ref:s,type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];if(!t||!c)return;let n=new FileReader;n.onload=e=>{let t=e.target?.result,n=new Image;n.onload=()=>{let e=document.createElement("canvas");e.width=n.width,e.height=n.height;let t=e.getContext("2d");t&&(t.drawImage(n,0,0),m(t.getImageData(0,0,n.width,n.height)),L||A("over"))},n.src=t},n.readAsDataURL(t)},className:"d-none"}),(0,t.jsxs)("div",{className:"d-flex justify-content-center gap-3 flex-wrap",children:[(0,t.jsx)("button",{onClick:()=>i.current?.click(),className:"btn btn-primary btn-lg px-5 shadow",children:"Upload Base Image"}),(0,t.jsx)("button",{onClick:()=>s.current?.click(),className:"btn btn-outline-secondary btn-lg px-5 shadow",disabled:!c,children:"Upload Overlay"})]})]}),l?(0,t.jsxs)("div",{className:"row g-5",children:[(0,t.jsx)("div",{className:"col-lg-4",children:(0,t.jsxs)("div",{className:"card shadow border-0",children:[(0,t.jsx)("div",{className:"card-header bg-primary text-white",children:(0,t.jsx)("h5",{className:"mb-0",children:"Controls"})}),(0,t.jsxs)("div",{className:"card-body overflow-auto",style:{maxHeight:"85vh"},children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("label",{className:"form-label fw-bold",children:["Rotation: ",w,"°"]}),(0,t.jsx)("input",{type:"range",className:"form-range",min:"-180",max:"180",step:"1",value:w,onChange:e=>y(Number(e.target.value))}),(0,t.jsxs)("div",{className:"btn-group w-100 mt-2",role:"group",children:[(0,t.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>y(0),children:"Reset"}),(0,t.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>y(90),children:"90°"}),(0,t.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>y(180),children:"180°"}),(0,t.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>y(-90),children:"-90°"})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("label",{className:"form-label fw-bold",children:["Brightness: ",j]}),(0,t.jsx)("input",{type:"range",className:"form-range",min:"-100",max:"100",value:j,onChange:e=>N(Number(e.target.value))})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("label",{className:"form-label fw-bold",children:["Contrast: ",C]}),(0,t.jsx)("input",{type:"range",className:"form-range",min:"-100",max:"100",value:C,onChange:e=>E(Number(e.target.value))})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("label",{className:"form-label fw-bold",children:["Hue Rotation: ",S,"°"]}),(0,t.jsx)("input",{type:"range",className:"form-range",min:"0",max:"360",value:S,onChange:e=>_(Number(e.target.value))})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"form-label fw-bold d-block mb-3",children:"Preset Filters"}),(0,t.jsxs)("div",{className:"d-grid gap-2",children:[(0,t.jsx)("button",{className:`btn btn-sm ${null===R?"btn-secondary":"btn-outline-secondary"}`,onClick:()=>$(null),children:"None (Original)"}),(0,t.jsx)("button",{className:`btn btn-sm ${"oceanic"===R?"btn-info text-white":"btn-outline-info"}`,onClick:()=>$("oceanic"),children:"Oceanic"}),(0,t.jsx)("button",{className:`btn btn-sm ${"islands"===R?"btn-info text-white":"btn-outline-info"}`,onClick:()=>$("islands"),children:"Islands"}),(0,t.jsx)("button",{className:`btn btn-sm ${"marine"===R?"btn-info text-white":"btn-outline-info"}`,onClick:()=>$("marine"),children:"Marine"}),(0,t.jsx)("button",{className:`btn btn-sm ${"seagreen"===R?"btn-info text-white":"btn-outline-info"}`,onClick:()=>$("seagreen"),children:"Seagreen"}),(0,t.jsx)("button",{className:`btn btn-sm ${"flagblue"===R?"btn-info text-white":"btn-outline-info"}`,onClick:()=>$("flagblue"),children:"Flagblue"}),(0,t.jsx)("button",{className:`btn btn-sm ${"liquid"===R?"btn-info text-white":"btn-outline-info"}`,onClick:()=>$("liquid"),children:"Liquid"}),(0,t.jsx)("button",{className:`btn btn-sm ${"diamante"===R?"btn-info text-white":"btn-outline-info"}`,onClick:()=>$("diamante"),children:"Diamante"}),(0,t.jsx)("button",{className:`btn btn-sm ${"vintage"===R?"btn-warning text-white":"btn-outline-warning"}`,onClick:()=>$("vintage"),children:"Vintage"}),(0,t.jsx)("button",{className:`btn btn-sm ${"perfume"===R?"btn-warning text-white":"btn-outline-warning"}`,onClick:()=>$("perfume"),children:"Perfume"}),(0,t.jsx)("button",{className:`btn btn-sm ${"serenity"===R?"btn-warning text-white":"btn-outline-warning"}`,onClick:()=>$("serenity"),children:"Serenity"}),(0,t.jsx)("button",{className:`btn btn-sm ${"lofi"===R?"btn-dark text-white":"btn-outline-dark"}`,onClick:()=>$("lofi"),children:"Lofi"}),(0,t.jsx)("button",{className:`btn btn-sm ${"cali"===R?"btn-dark text-white":"btn-outline-dark"}`,onClick:()=>$("cali"),children:"Cali"}),(0,t.jsx)("button",{className:`btn btn-sm ${"obsidian"===R?"btn-dark text-white":"btn-outline-dark"}`,onClick:()=>$("obsidian"),children:"Obsidian"}),(0,t.jsx)("button",{className:`btn btn-sm ${"firenze"===R?"btn-dark text-white":"btn-outline-dark"}`,onClick:()=>$("firenze"),children:"Firenze"}),(0,t.jsx)("button",{className:`btn btn-sm ${"dramatic"===R?"btn-dark text-white":"btn-outline-dark"}`,onClick:()=>$("dramatic"),children:"Dramatic"}),(0,t.jsx)("button",{className:`btn btn-sm ${"golden"===R?"btn-dark text-white":"btn-outline-dark"}`,onClick:()=>$("golden"),children:"Golden"}),(0,t.jsx)("button",{className:`btn btn-sm ${"pastel_pink"===R?"btn-dark text-white":"btn-outline-dark"}`,onClick:()=>$("pastel_pink"),children:"Pastel Pink"}),(0,t.jsx)("button",{className:`btn btn-sm ${"radio"===R?"btn-danger text-white":"btn-outline-danger"}`,onClick:()=>$("radio"),children:"Radio"}),(0,t.jsx)("button",{className:`btn btn-sm ${"twenties"===R?"btn-secondary text-white":"btn-outline-secondary"}`,onClick:()=>$("twenties"),children:"Twenties"}),(0,t.jsx)("button",{className:`btn btn-sm ${"rosetint"===R?"btn-pink text-white":"btn-outline-pink"}`,onClick:()=>$("rosetint"),children:"Rosetint"}),(0,t.jsx)("button",{className:`btn btn-sm ${"mauve"===R?"btn-purple text-white":"btn-outline-purple"}`,onClick:()=>$("mauve"),children:"Mauve"}),(0,t.jsx)("button",{className:`btn btn-sm ${"bluechrome"===R?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>$("bluechrome"),children:"Bluechrome"})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h5",{className:"form-label fw-bold d-block mb-3",children:"Blend"}),b?(0,t.jsxs)("div",{className:"d-grid gap-2",children:[(0,t.jsx)("button",{className:`btn btn-sm ${null===L?"btn-secondary":"btn-outline-secondary"}`,onClick:()=>A(null),children:"None"}),(0,t.jsx)("button",{className:`btn btn-sm ${"over"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("over"),children:"Blend (Over)"}),(0,t.jsx)("button",{className:`btn btn-sm ${"overlay"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("overlay"),children:"Overlay"}),(0,t.jsx)("button",{className:`btn btn-sm ${"atop"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("atop"),children:"Atop"}),(0,t.jsx)("button",{className:`btn btn-sm ${"plus"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("plus"),children:"Plus"}),(0,t.jsx)("button",{className:`btn btn-sm ${"multiply"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("multiply"),children:"Multiply"}),(0,t.jsx)("button",{className:`btn btn-sm ${"burn"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("burn"),children:"Burn"}),(0,t.jsx)("button",{className:`btn btn-sm ${"difference"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("difference"),children:"Difference"}),(0,t.jsx)("button",{className:`btn btn-sm ${"soft_light"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("soft_light"),children:"Soft Light"}),(0,t.jsx)("button",{className:`btn btn-sm ${"hard_light"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("hard_light"),children:"Hard Light"}),(0,t.jsx)("button",{className:`btn btn-sm ${"dodge"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("dodge"),children:"Dodge"}),(0,t.jsx)("button",{className:`btn btn-sm ${"exclusion"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("exclusion"),children:"Exclusion"}),(0,t.jsx)("button",{className:`btn btn-sm ${"lighten"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("lighten"),children:"Lighten"}),(0,t.jsx)("button",{className:`btn btn-sm ${"darken"===L?"btn-primary text-white":"btn-outline-primary"}`,onClick:()=>A("darken"),children:"Darken"})]}):(0,t.jsx)("p",{className:"text-muted small",children:"Upload an overlay image to enable blend modes"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"form-label fw-bold",children:"Flip & Basic Filters"}),(0,t.jsxs)("div",{className:"d-grid gap-2",children:[(0,t.jsx)("button",{className:`btn ${T.flipHorizontal?"btn-primary":"btn-outline-primary"}`,onClick:()=>M(e=>({...e,flipHorizontal:!e.flipHorizontal})),children:"↔ Flip Horizontal"}),(0,t.jsx)("button",{className:`btn ${T.flipVertical?"btn-primary":"btn-outline-primary"}`,onClick:()=>M(e=>({...e,flipVertical:!e.flipVertical})),children:"↕ Flip Vertical"}),(0,t.jsx)("button",{className:`btn ${T.grayscale?"btn-dark":"btn-outline-dark"}`,onClick:()=>M(e=>({...e,grayscale:!e.grayscale})),children:"Grayscale"}),(0,t.jsx)("button",{className:`btn ${T.sepia?"btn-warning text-white":"btn-outline-warning"}`,onClick:()=>M(e=>({...e,sepia:!e.sepia})),children:"Sepia"}),(0,t.jsx)("button",{className:`btn ${T.sharpen?"btn-info":"btn-outline-info"}`,onClick:()=>M(e=>({...e,sharpen:!e.sharpen})),children:"Sharpen"})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("label",{className:"form-label fw-bold",children:["Blur Radius: ",v,"px"]}),(0,t.jsx)("input",{type:"range",className:"form-range",min:"0",max:"30",value:v,onChange:e=>k(Number(e.target.value))})]}),(0,t.jsxs)("div",{className:"mb-4 p-3 border rounded bg-light",children:[(0,t.jsxs)("div",{className:"form-check mb-3",children:[(0,t.jsx)("input",{className:"form-check-input",type:"checkbox",checked:O.enabled,onChange:e=>P(t=>({...t,enabled:e.target.checked}))}),(0,t.jsx)("label",{className:"form-check-label fw-bold",children:"Add Watermark"})]}),O.enabled&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"text",className:"form-control mb-2",placeholder:"Watermark text",value:O.text,onChange:e=>P(t=>({...t,text:e.target.value}))}),(0,t.jsx)("input",{type:"range",className:"form-range mb-2",min:"12",max:"120",value:O.size,onChange:e=>P(t=>({...t,size:Number(e.target.value)}))}),(0,t.jsxs)("div",{className:"mb-2",children:["Size: ",O.size,"px"]}),(0,t.jsx)("input",{type:"color",className:"form-control form-control-color mb-2",value:O.color,onChange:e=>P(t=>({...t,color:e.target.value}))}),(0,t.jsxs)("select",{className:"form-select",value:O.position,onChange:e=>P(t=>({...t,position:e.target.value})),children:[(0,t.jsx)("option",{value:"top-left",children:"Top Left"}),(0,t.jsx)("option",{value:"top-right",children:"Top Right"}),(0,t.jsx)("option",{value:"bottom-left",children:"Bottom Left"}),(0,t.jsx)("option",{value:"bottom-right",children:"Bottom Right"}),(0,t.jsx)("option",{value:"center",children:"Center"})]})]})]}),(0,t.jsxs)("div",{className:"mt-5 p-3 border rounded bg-light",children:[(0,t.jsx)("h5",{className:"fw-bold mb-3",children:"Canvas Animation Recording"}),(0,t.jsx)("p",{className:"small text-muted",children:"Record live effects → MP4 (encoded in worker)"}),(0,t.jsxs)("div",{className:"d-flex gap-2 mb-3",children:[(0,t.jsxs)("button",{className:"btn btn-danger",onClick:z?()=>{F.current&&(clearInterval(F.current),F.current=null),D(!1)}:()=>{u&&e.current&&(D(!0),B([]),F.current=setInterval(()=>{e.current.toBlob(async e=>{if(!e)return;let t=new Uint8Array(await e.arrayBuffer());B(e=>[...e,t])},"image/png")},1e3/W))},disabled:!u,children:[z?"Stop":"Start"," Canvas Record"]}),(0,t.jsxs)("button",{className:"btn btn-success",onClick:es,disabled:z||0===U.length,children:["Export MP4 (",U.length," frames)"]})]})]}),(0,t.jsxs)("div",{className:"mt-5 p-3 border rounded bg-light",children:[(0,t.jsx)("h5",{className:"fw-bold mb-3",children:"Full Screen Recording"}),(0,t.jsxs)("div",{className:"d-flex gap-2 mb-3 flex-wrap",children:[(0,t.jsxs)("button",{className:"btn btn-danger",onClick:q?()=>{X.current&&(X.current.stop(),X.current=null),V(!1),H(null)}:el,children:[q?"Stop":"Start"," Full Screen"]}),(0,t.jsx)("button",{className:"btn btn-success",onClick:eo,disabled:q||0===G.length,children:"Export MP4"})]})]}),(0,t.jsxs)("div",{className:"mt-5 p-3 border rounded bg-light",children:[(0,t.jsx)("h5",{className:"fw-bold mb-3",children:"Region Recording"}),(0,t.jsxs)("div",{className:"d-flex gap-2 mb-3 flex-wrap",children:[(0,t.jsx)("button",{className:"btn btn-primary",onClick:()=>{er(!0),ei(null)},disabled:K||en,children:"Select Region"}),(0,t.jsx)("button",{className:"btn btn-danger",onClick:()=>{ee.current&&(ee.current.stop(),ee.current=null),J(!1),H(null)},disabled:!K,children:"Stop"}),(0,t.jsx)("button",{className:"btn btn-success",onClick:ed,disabled:K||0===Q.length,children:"Export MP4"})]})]})]})]})}),(0,t.jsx)("div",{className:"col-lg-8",children:(0,t.jsxs)("div",{className:"card shadow border-0",children:[(0,t.jsx)("div",{className:"card-header bg-primary text-white text-center",children:(0,t.jsx)("h5",{className:"mb-0",children:"Live Preview"})}),(0,t.jsx)("div",{className:"card-body p-4 text-center",children:p?(0,t.jsxs)("div",{className:"d-flex flex-column align-items-center justify-content-center",style:{minHeight:"600px"},children:[(0,t.jsx)("div",{className:"spinner-border text-primary",style:{width:"5rem",height:"5rem"}}),(0,t.jsx)("p",{className:"mt-4 fs-4 text-muted",children:"Applying effects..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("canvas",{ref:e,className:"img-fluid rounded shadow",style:{maxHeight:"75vh",border:"1px solid #ddd"}}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("button",{onClick:()=>{u&&e.current&&e.current.toBlob(e=>{if(!e)return;let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t;let r=R?`${R}_`:"",a=L?`blend_${L}_`:"";n.download=`edited_${a}${r}${w}deg_${0!==j?`b${j}_`:""}${0!==C?`c${C}_`:""}${0!==S?`h${S}_`:""}image.png`,n.click(),URL.revokeObjectURL(t)},"image/png")},className:"btn btn-success btn-lg shadow",children:"Download Image"})})]})})]})})]}):(0,t.jsx)("div",{className:"text-center py-5",children:(0,t.jsxs)("div",{className:"bg-white rounded-4 shadow p-5",children:[(0,t.jsx)("p",{className:"display-6 text-muted mb-4",children:"No image loaded"}),(0,t.jsx)("p",{className:"lead",children:"Upload an image to start editing and recording"})]})})]})]})}e.s(["default",()=>i])}]);