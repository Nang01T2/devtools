(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,781044,808800,e=>{"use strict";var t=e.i(356421),n=e.i(115080),r=e.i(693125),o=e.i(850990);function i(e,t){return({state:n,dispatch:r})=>{if(n.readOnly)return!1;let o=e(t,n);return!!o&&(r(n.update(o)),!0)}}let l=i(function(e,t,n=t.selection.ranges){let r=[],o=-1;for(let{from:e,to:i}of n){let n=r.length,l=1e9,s=c(t,e).line;if(s){for(let n=e;n<=i;){let a=t.doc.lineAt(n);if(a.from>o&&(e==i||i>a.from)){o=a.from;let e=/^\s*/.exec(a.text)[0].length,t=e==a.length,n=a.text.slice(e,e+s.length)==s?e:-1;e<a.text.length&&e<l&&(l=e),r.push({line:a,comment:n,token:s,indent:e,empty:t,single:!1})}n=a.to+1}if(l<1e9)for(let e=n;e<r.length;e++)r[e].indent<r[e].line.text.length&&(r[e].indent=l);r.length==n+1&&(r[n].single=!0)}}if(2!=e&&r.some(e=>e.comment<0&&(!e.empty||e.single))){let e=[];for(let{line:t,token:n,indent:o,empty:i,single:l}of r)(l||!i)&&e.push({from:t.from+o,insert:n+" "});let n=t.changes(e);return{changes:n,selection:t.selection.map(n,1)}}if(1!=e&&r.some(e=>e.comment>=0)){let e=[];for(let{line:t,comment:n,token:o}of r)if(n>=0){let r=t.from+n,i=r+o.length;" "==t.text[i-t.from]&&i++,e.push({from:r,to:i})}return{changes:e}}return null},0),s=i(h,0),a=i((e,t)=>h(e,t,function(e){let t=[];for(let n of e.selection.ranges){let r=e.doc.lineAt(n.from),o=n.to<=r.to?r:e.doc.lineAt(n.to);o.from>r.from&&o.from==n.to&&(o=n.to==r.to+1?r:e.doc.lineAt(n.to-1));let i=t.length-1;i>=0&&t[i].to>r.from?t[i].to=o.to:t.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:o.to})}return t}(t)),0);function c(e,t){let n=e.languageDataAt("commentTokens",t,1);return n.length?n[0]:{}}function h(e,t,n=t.selection.ranges){let r=n.map(e=>c(t,e.from).block);if(!r.every(e=>e))return null;let o=n.map((e,n)=>(function(e,{open:t,close:n},r,o){let i,l,s=e.sliceDoc(r-50,r),a=e.sliceDoc(o,o+50),c=/\s*$/.exec(s)[0].length,h=/^\s*/.exec(a)[0].length,u=s.length-c;if(s.slice(u-t.length,u)==t&&a.slice(h,h+n.length)==n)return{open:{pos:r-c,margin:c&&1},close:{pos:o+h,margin:h&&1}};o-r<=100?i=l=e.sliceDoc(r,o):(i=e.sliceDoc(r,r+50),l=e.sliceDoc(o-50,o));let f=/^\s*/.exec(i)[0].length,d=/\s*$/.exec(l)[0].length,m=l.length-d-n.length;return i.slice(f,f+t.length)==t&&l.slice(m,m+n.length)==n?{open:{pos:r+f+t.length,margin:+!!/\s/.test(i.charAt(f+t.length))},close:{pos:o-d-n.length,margin:+!!/\s/.test(l.charAt(m-1))}}:null})(t,r[n],e.from,e.to));if(2!=e&&!o.every(e=>e))return{changes:t.changes(n.map((e,t)=>o[t]?[]:[{from:e.from,insert:r[t].open+" "},{from:e.to,insert:" "+r[t].close}]))};if(1!=e&&o.some(e=>e)){let e=[];for(let t=0,n;t<o.length;t++)if(n=o[t]){let o=r[t],{open:i,close:l}=n;e.push({from:i.pos-o.open.length,to:i.pos+i.margin},{from:l.pos-l.margin,to:l.pos+o.close.length})}return{changes:e}}return null}let u=t.Annotation.define(),f=t.Annotation.define(),d=t.Facet.define(),m=t.Facet.define({combine:e=>(0,t.combineConfig)(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,r)=>e(n,r)||t(n,r)})}),p=t.StateField.define({create:()=>B.empty,update(e,n){let r=n.state.facet(m),o=n.annotation(u);if(o){let t=w.fromTransaction(n,o.selection),i=o.side,l=0==i?e.undone:e.done;return l=t?A(l,l.length,r.minDepth,t):M(l,n.startState.selection),new B(0==i?o.rest:l,0==i?l:o.rest)}let i=n.annotation(f);if(("full"==i||"before"==i)&&(e=e.isolate()),!1===n.annotation(t.Transaction.addToHistory))return n.changes.empty?e:e.addMapping(n.changes.desc);let l=w.fromTransaction(n),s=n.annotation(t.Transaction.time),a=n.annotation(t.Transaction.userEvent);return l?e=e.addChanges(l,s,a,r,n):n.selection&&(e=e.addSelection(n.startState.selection,s,a,r.newGroupDelay)),("full"==i||"after"==i)&&(e=e.isolate()),e},toJSON:e=>({done:e.done.map(e=>e.toJSON()),undone:e.undone.map(e=>e.toJSON())}),fromJSON:e=>new B(e.done.map(w.fromJSON),e.undone.map(w.fromJSON))});function g(e={}){return[p,m.of(e),n.EditorView.domEventHandlers({beforeinput(e,t){let n="historyUndo"==e.inputType?y:"historyRedo"==e.inputType?S:null;return!!n&&(e.preventDefault(),n(t))}})]}function v(e,t){return function({state:n,dispatch:r}){if(!t&&n.readOnly)return!1;let o=n.field(p,!1);if(!o)return!1;let i=o.pop(e,n,t);return!!i&&(r(i),!0)}}let y=v(0,!1),S=v(1,!1),x=v(0,!0),k=v(1,!0);class w{constructor(e,t,n,r,o){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=r,this.selectionsAfter=o}setSelAfter(e){return new w(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:null==(e=this.changes)?void 0:e.toJSON(),mapped:null==(t=this.mapped)?void 0:t.toJSON(),startSelection:null==(n=this.startSelection)?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(e=>e.toJSON())}}static fromJSON(e){return new w(e.changes&&t.ChangeSet.fromJSON(e.changes),[],e.mapped&&t.ChangeDesc.fromJSON(e.mapped),e.startSelection&&t.EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(t.EditorSelection.fromJSON))}static fromTransaction(e,t){let n=C;for(let t of e.startState.facet(d)){let r=t(e);r.length&&(n=n.concat(r))}return!n.length&&e.changes.empty?null:new w(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,C)}static selection(e){return new w(void 0,C,void 0,void 0,e)}}function A(e,t,n,r){let o=e.slice(t+1>n+20?t-n-1:0,t);return o.push(r),o}function b(e,t){return e.length?t.length?e.concat(t):e:t}let C=[];function M(e,t){if(!e.length)return[w.selection([t])];{let n=e[e.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-200));return r.length&&r[r.length-1].eq(t)?e:(r.push(t),A(e,e.length-1,1e9,n.setSelAfter(r)))}}function E(e,n){if(!e.length)return e;let r=e.length,o=C;for(;r;){let i=function(e,n,r){let o=b(e.selectionsAfter.length?e.selectionsAfter.map(e=>e.map(n)):C,r);if(!e.changes)return w.selection(o);let i=e.changes.map(n),l=n.mapDesc(e.changes,!0),s=e.mapped?e.mapped.composeDesc(l):l;return new w(i,t.StateEffect.mapEffects(e.effects,n),s,e.startSelection.map(l),o)}(e[r-1],n,o);if(i.changes&&!i.changes.empty||i.effects.length){let t=e.slice(0,r);return t[r-1]=i,t}n=i.mapped,r--,o=i.selectionsAfter}return o.length?[w.selection(o)]:C}let D=/^(input\.type|delete)($|\.)/;class B{constructor(e,t,n=0,r){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=r}isolate(){return this.prevTime?new B(this.done,this.undone):this}addChanges(e,n,r,o,i){var l,s;let a,c,h=this.done,u=h[h.length-1];return new B(h=u&&u.changes&&!u.changes.empty&&e.changes&&(!r||D.test(r))&&(!u.selectionsAfter.length&&n-this.prevTime<o.newGroupDelay&&o.joinToEvent(i,(l=u.changes,s=e.changes,a=[],c=!1,l.iterChangedRanges((e,t)=>a.push(e,t)),s.iterChangedRanges((e,t,n,r)=>{for(let e=0;e<a.length;){let t=a[e++],o=a[e++];r>=t&&n<=o&&(c=!0)}}),c))||"input.type.compose"==r)?A(h,h.length-1,o.minDepth,new w(e.changes.compose(u.changes),b(t.StateEffect.mapEffects(e.effects,u.changes),u.effects),u.mapped,u.startSelection,C)):A(h,h.length,o.minDepth,e),C,n,r)}addSelection(e,t,n,r){var o;let i=this.done.length?this.done[this.done.length-1].selectionsAfter:C;return i.length>0&&t-this.prevTime<r&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&(o=i[i.length-1],o.ranges.length==e.ranges.length&&0===o.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length)?this:new B(M(this.done,e),this.undone,t,n)}addMapping(e){return new B(E(this.done,e),E(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let r=0==e?this.done:this.undone;if(0==r.length)return null;let o=r[r.length-1],i=o.selectionsAfter[0]||t.selection;if(n&&o.selectionsAfter.length){let n,l;return t.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:u.of({side:e,rest:(n=r[r.length-1],(l=r.slice())[r.length-1]=n.setSelAfter(n.selectionsAfter.slice(0,n.selectionsAfter.length-1)),l),selection:i}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0})}{if(!o.changes)return null;let n=1==r.length?C:r.slice(0,r.length-1);return o.mapped&&(n=E(n,o.mapped)),t.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:u.of({side:e,rest:n,selection:i}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}}}B.empty=new B(C,C);let L=[{key:"Mod-z",run:y,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:S,preventDefault:!0},{linux:"Ctrl-Shift-z",run:S,preventDefault:!0},{key:"Mod-u",run:x,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:k,preventDefault:!0}];function T(e,n){return t.EditorSelection.create(e.ranges.map(n),e.mainIndex)}function O(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function P({state:e,dispatch:t},n){let r=T(e.selection,n);return!r.eq(e.selection,!0)&&(t(O(e,r)),!0)}function R(e,n){return t.EditorSelection.cursor(n?e.to:e.from)}function I(e,t){return P(e,n=>n.empty?e.moveByChar(n,t):R(n,t))}function q(e){return e.textDirectionAt(e.state.selection.main.head)==n.Direction.LTR}let V=e=>I(e,!q(e)),F=e=>I(e,q(e));function W(e,t){return P(e,n=>n.empty?e.moveByGroup(n,t):R(n,t))}function N(e,n,i){let l,s,a=(0,r.syntaxTree)(e).resolveInner(n.head),c=i?o.NodeProp.closedBy:o.NodeProp.openedBy;for(let t=n.head;;){let n=i?a.childAfter(t):a.childBefore(t);if(!n)break;!function(e,t,n){if(t.type.prop(n))return!0;let r=t.to-t.from;return r&&(r>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}(e,n,c)?t=i?n.to:n.from:a=n}return s=a.type.prop(c)&&(l=i?(0,r.matchBrackets)(e,a.from,1):(0,r.matchBrackets)(e,a.to,-1))&&l.matched?i?l.end.to:l.end.from:i?a.to:a.from,t.EditorSelection.cursor(s,i?-1:1)}function z(e,t){return P(e,n=>{if(!n.empty)return R(n,t);let r=e.moveVertically(n,t);return r.head!=n.head?r:e.moveToLineBoundary(n,t)})}"undefined"!=typeof Intl&&Intl.Segmenter;let U=e=>z(e,!1),J=e=>z(e,!0);function $(e){let t=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,r=0,o=0,i;if(t){for(let t of e.state.facet(n.EditorView.scrollMargins)){let n=t(e);(null==n?void 0:n.top)&&(r=Math.max(null==n?void 0:n.top,r)),(null==n?void 0:n.bottom)&&(o=Math.max(null==n?void 0:n.bottom,o))}i=e.scrollDOM.clientHeight-r-o}else i=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:o,selfScroll:t,height:Math.max(e.defaultLineHeight,i-5)}}function H(e,t){let r,o=$(e),{state:i}=e,l=T(i.selection,n=>n.empty?e.moveVertically(n,t,o.height):R(n,t));if(l.eq(i.selection))return!1;if(o.selfScroll){let t=e.coordsAtPos(i.selection.main.head),s=e.scrollDOM.getBoundingClientRect(),a=s.top+o.marginTop,c=s.bottom-o.marginBottom;t&&t.top>a&&t.bottom<c&&(r=n.EditorView.scrollIntoView(l.main.head,{y:"start",yMargin:t.top-a}))}return e.dispatch(O(i,l),{effects:r}),!0}let G=e=>H(e,!1),K=e=>H(e,!0);function j(e,n,r){let o=e.lineBlockAt(n.head),i=e.moveToLineBoundary(n,r);if(i.head==n.head&&i.head!=(r?o.to:o.from)&&(i=e.moveToLineBoundary(n,r,!1)),!r&&i.head==o.from&&o.length){let r=/^\s*/.exec(e.state.sliceDoc(o.from,Math.min(o.from+100,o.to)))[0].length;r&&n.head!=o.from+r&&(i=t.EditorSelection.cursor(o.from+r))}return i}function Q(e,n){let r=T(e.state.selection,e=>{let r=n(e);return t.EditorSelection.range(e.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return!r.eq(e.state.selection)&&(e.dispatch(O(e.state,r)),!0)}function _(e,t){return Q(e,n=>e.moveByChar(n,t))}let X=e=>_(e,!q(e)),Y=e=>_(e,q(e));function Z(e,t){return Q(e,n=>e.moveByGroup(n,t))}function ee(e,t){return Q(e,n=>e.moveVertically(n,t))}let et=e=>ee(e,!1),en=e=>ee(e,!0);function er(e,t){return Q(e,n=>e.moveVertically(n,t,$(e).height))}let eo=e=>er(e,!1),ei=e=>er(e,!0),el=({state:e,dispatch:t})=>(t(O(e,{anchor:0})),!0),es=({state:e,dispatch:t})=>(t(O(e,{anchor:e.doc.length})),!0),ea=({state:e,dispatch:t})=>(t(O(e,{anchor:e.selection.main.anchor,head:0})),!0),ec=({state:e,dispatch:t})=>(t(O(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0);function eh(e,n){let{state:r}=e,o=r.selection,i=r.selection.ranges.slice();for(let t of r.selection.ranges){let o=r.doc.lineAt(t.head);if(n?o.to<e.state.doc.length:o.from>0)for(let r=t;;){let t=e.moveVertically(r,n);if(t.head<o.from||t.head>o.to){i.some(e=>e.head==t.head)||i.push(t);break}if(t.head==r.head)break;r=t}}return i.length!=o.ranges.length&&(e.dispatch(O(r,t.EditorSelection.create(i,i.length-1))),!0)}function eu(e,r){if(e.state.readOnly)return!1;let o="delete.selection",{state:i}=e,l=i.changeByRange(n=>{let{from:i,to:l}=n;if(i==l){let t=r(n);t<i?(o="delete.backward",t=ef(e,t,!1)):t>i&&(o="delete.forward",t=ef(e,t,!0)),i=Math.min(i,t),l=Math.max(l,t)}else i=ef(e,i,!1),l=ef(e,l,!0);return i==l?{range:n}:{changes:{from:i,to:l},range:t.EditorSelection.cursor(i,i<n.head?-1:1)}});return!l.changes.empty&&(e.dispatch(i.update(l,{scrollIntoView:!0,userEvent:o,effects:"delete.selection"==o?n.EditorView.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function ef(e,t,r){if(e instanceof n.EditorView)for(let o of e.state.facet(n.EditorView.atomicRanges).map(t=>t(e)))o.between(t,t,(e,n)=>{e<t&&n>t&&(t=r?n:e)});return t}let ed=(e,n,o)=>eu(e,i=>{let l=i.from,{state:s}=e,a=s.doc.lineAt(l),c,h;if(o&&!n&&l>a.from&&l<a.from+200&&!/[^ \t]/.test(c=a.text.slice(0,l-a.from))){if("	"==c[c.length-1])return l-1;let e=(0,t.countColumn)(c,s.tabSize)%(0,r.getIndentUnit)(s)||(0,r.getIndentUnit)(s);for(let t=0;t<e&&" "==c[c.length-1-t];t++)l--;h=l}else(h=(0,t.findClusterBreak)(a.text,l-a.from,n,n)+a.from)==l&&a.number!=(n?s.doc.lines:1)?h+=n?1:-1:!n&&/[\ufe00-\ufe0f]/.test(a.text.slice(h-a.from,l-a.from))&&(h=(0,t.findClusterBreak)(a.text,h-a.from,!1,!1)+a.from);return h}),em=e=>ed(e,!1,!0),ep=e=>ed(e,!0,!1),eg=(e,n)=>eu(e,r=>{let o=r.head,{state:i}=e,l=i.doc.lineAt(o),s=i.charCategorizer(o);for(let e=null;;){if(o==(n?l.to:l.from)){o==r.head&&l.number!=(n?i.doc.lines:1)&&(o+=n?1:-1);break}let a=(0,t.findClusterBreak)(l.text,o-l.from,n)+l.from,c=l.text.slice(Math.min(o,a)-l.from,Math.max(o,a)-l.from),h=s(c);if(null!=e&&h!=e)break;(" "!=c||o!=r.head)&&(e=h),o=a}return o}),ev=e=>eg(e,!1);function ey(e){let t=[],n=-1;for(let r of e.selection.ranges){let o=e.doc.lineAt(r.from),i=e.doc.lineAt(r.to);if(r.empty||r.to!=i.from||(i=e.doc.lineAt(r.to-1)),n>=o.number){let e=t[t.length-1];e.to=i.to,e.ranges.push(r)}else t.push({from:o.from,to:i.to,ranges:[r]});n=i.number+1}return t}function eS(e,n,r){if(e.readOnly)return!1;let o=[],i=[];for(let n of ey(e)){if(r?n.to==e.doc.length:0==n.from)continue;let l=e.doc.lineAt(r?n.to+1:n.from-1),s=l.length+1;if(r)for(let r of(o.push({from:n.to,to:l.to},{from:n.from,insert:l.text+e.lineBreak}),n.ranges))i.push(t.EditorSelection.range(Math.min(e.doc.length,r.anchor+s),Math.min(e.doc.length,r.head+s)));else for(let r of(o.push({from:l.from,to:n.from},{from:n.to,insert:e.lineBreak+l.text}),n.ranges))i.push(t.EditorSelection.range(r.anchor-s,r.head-s))}return!!o.length&&(n(e.update({changes:o,scrollIntoView:!0,selection:t.EditorSelection.create(i,e.selection.mainIndex),userEvent:"move.line"})),!0)}function ex(e,t,n){if(e.readOnly)return!1;let r=[];for(let t of ey(e))n?r.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):r.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});return t(e.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}let ek=e=>{if(e.state.readOnly)return!1;let{state:t}=e,n=t.changes(ey(t).map(({from:e,to:n})=>(e>0?e--:n<t.doc.length&&n++,{from:e,to:n}))),r=T(t.selection,t=>{let n;if(e.lineWrapping){let r=e.lineBlockAt(t.head),o=e.coordsAtPos(t.head,t.assoc||1);o&&(n=r.bottom+e.documentTop-o.bottom+e.defaultLineHeight/2)}return e.moveVertically(t,!0,n)}).map(n);return e.dispatch({changes:n,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0},ew=eb(!1),eA=eb(!0);function eb(e){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let l=n.changeByRange(i=>{let{from:l,to:s}=i,a=n.doc.lineAt(l),c=!e&&l==s&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let n=(0,r.syntaxTree)(e).resolveInner(t),i=n.childBefore(t),l=n.childAfter(t),s;return i&&l&&i.to<=t&&l.from>=t&&(s=i.type.prop(o.NodeProp.closedBy))&&s.indexOf(l.name)>-1&&e.doc.lineAt(i.to).from==e.doc.lineAt(l.from).from&&!/\S/.test(e.sliceDoc(i.to,l.from))?{from:i.to,to:l.from}:null}(n,l);e&&(l=s=(s<=a.to?a:n.doc.lineAt(s)).to);let h=new r.IndentContext(n,{simulateBreak:l,simulateDoubleBreak:!!c}),u=(0,r.getIndentation)(h,l);for(null==u&&(u=(0,t.countColumn)(/^\s*/.exec(n.doc.lineAt(l).text)[0],n.tabSize));s<a.to&&/\s/.test(a.text[s-a.from]);)s++;c?{from:l,to:s}=c:l>a.from&&l<a.from+100&&!/\S/.test(a.text.slice(0,l))&&(l=a.from);let f=["",(0,r.indentString)(n,u)];return c&&f.push((0,r.indentString)(n,h.lineIndent(a.from,-1))),{changes:{from:l,to:s,insert:t.Text.of(f)},range:t.EditorSelection.cursor(l+1+f[1].length)}});return i(n.update(l,{scrollIntoView:!0,userEvent:"input"})),!0}}function eC(e,n){let r=-1;return e.changeByRange(o=>{let i=[];for(let t=o.from;t<=o.to;){let l=e.doc.lineAt(t);l.number>r&&(o.empty||o.to>l.from)&&(n(l,i,o),r=l.number),t=l.to+1}let l=e.changes(i);return{changes:i,range:t.EditorSelection.range(l.mapPos(o.anchor,1),l.mapPos(o.head,1))}})}let eM=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(eC(e,(t,n)=>{n.push({from:t.from,insert:e.facet(r.indentUnit)})}),{userEvent:"input.indent"})),!0),eE=({state:e,dispatch:n})=>!e.readOnly&&(n(e.update(eC(e,(n,o)=>{let i=/^\s*/.exec(n.text)[0];if(!i)return;let l=(0,t.countColumn)(i,e.tabSize),s=0,a=(0,r.indentString)(e,Math.max(0,l-(0,r.getIndentUnit)(e)));for(;s<i.length&&s<a.length&&i.charCodeAt(s)==a.charCodeAt(s);)s++;o.push({from:n.from+s,to:n.from+i.length,insert:a.slice(s)})}),{userEvent:"delete.dedent"})),!0),eD=[{key:"Ctrl-b",run:V,shift:X,preventDefault:!0},{key:"Ctrl-f",run:F,shift:Y},{key:"Ctrl-p",run:U,shift:et},{key:"Ctrl-n",run:J,shift:en},{key:"Ctrl-a",run:e=>P(e,n=>t.EditorSelection.cursor(e.lineBlockAt(n.head).from,1)),shift:e=>Q(e,n=>t.EditorSelection.cursor(e.lineBlockAt(n.head).from))},{key:"Ctrl-e",run:e=>P(e,n=>t.EditorSelection.cursor(e.lineBlockAt(n.head).to,-1)),shift:e=>Q(e,n=>t.EditorSelection.cursor(e.lineBlockAt(n.head).to))},{key:"Ctrl-d",run:ep},{key:"Ctrl-h",run:em},{key:"Ctrl-k",run:e=>eu(e,t=>{let n=e.lineBlockAt(t.head).to;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)})},{key:"Ctrl-Alt-h",run:ev},{key:"Ctrl-o",run:({state:e,dispatch:n})=>{if(e.readOnly)return!1;let r=e.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t.Text.of(["",""])},range:t.EditorSelection.cursor(e.from)}));return n(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:e,dispatch:n})=>{if(e.readOnly)return!1;let r=e.changeByRange(n=>{if(!n.empty||0==n.from||n.from==e.doc.length)return{range:n};let r=n.from,o=e.doc.lineAt(r),i=r==o.from?r-1:(0,t.findClusterBreak)(o.text,r-o.from,!1)+o.from,l=r==o.to?r+1:(0,t.findClusterBreak)(o.text,r-o.from,!0)+o.from;return{changes:{from:i,to:l,insert:e.doc.slice(r,l).append(e.doc.slice(i,r))},range:t.EditorSelection.cursor(l)}});return!r.changes.empty&&(n(e.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:K}],eB=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>P(e,t=>N(e.state,t,!q(e))),shift:e=>Q(e,t=>N(e.state,t,!q(e)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>P(e,t=>N(e.state,t,q(e))),shift:e=>Q(e,t=>N(e.state,t,q(e)))},{key:"Alt-ArrowUp",run:({state:e,dispatch:t})=>eS(e,t,!1)},{key:"Shift-Alt-ArrowUp",run:({state:e,dispatch:t})=>ex(e,t,!1)},{key:"Alt-ArrowDown",run:({state:e,dispatch:t})=>eS(e,t,!0)},{key:"Shift-Alt-ArrowDown",run:({state:e,dispatch:t})=>ex(e,t,!0)},{key:"Mod-Alt-ArrowUp",run:e=>eh(e,!1)},{key:"Mod-Alt-ArrowDown",run:e=>eh(e,!0)},{key:"Escape",run:({state:e,dispatch:n})=>{let r=e.selection,o=null;return r.ranges.length>1?o=t.EditorSelection.create([r.main]):r.main.empty||(o=t.EditorSelection.create([t.EditorSelection.cursor(r.main.head)])),!!o&&(n(O(e,o)),!0)}},{key:"Mod-Enter",run:eA},{key:"Alt-l",mac:"Ctrl-l",run:({state:e,dispatch:n})=>{let r=ey(e).map(({from:n,to:r})=>t.EditorSelection.range(n,Math.min(r+1,e.doc.length)));return n(e.update({selection:t.EditorSelection.create(r),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:e,dispatch:n})=>{let o=T(e.selection,n=>{let o=(0,r.syntaxTree)(e),i=o.resolveStack(n.from,1);if(n.empty){let e=o.resolveStack(n.from,-1);e.node.from>=i.node.from&&e.node.to<=i.node.to&&(i=e)}for(let e=i;e;e=e.next){let{node:r}=e;if((r.from<n.from&&r.to>=n.to||r.to>n.to&&r.from<=n.from)&&e.next)return t.EditorSelection.range(r.to,r.from)}return n});return!o.eq(e.selection)&&(n(O(e,o)),!0)},preventDefault:!0},{key:"Mod-[",run:eE},{key:"Mod-]",run:eM},{key:"Mod-Alt-\\",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=Object.create(null),o=new r.IndentContext(e,{overrideIndentation:e=>{let t=n[e];return null==t?-1:t}}),i=eC(e,(t,i,l)=>{let s=(0,r.getIndentation)(o,t.from);if(null==s)return;/\S/.test(t.text)||(s=0);let a=/^\s*/.exec(t.text)[0],c=(0,r.indentString)(e,s);(a!=c||l.from<t.from+a.length)&&(n[t.from]=s,i.push({from:t.from,to:t.from+a.length,insert:c}))});return i.changes.empty||t(e.update(i,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:ek},{key:"Shift-Mod-\\",run:({state:e,dispatch:n})=>{let o,i;return o=!1,i=T(e.selection,n=>{let i=(0,r.matchBrackets)(e,n.head,-1)||(0,r.matchBrackets)(e,n.head,1)||n.head>0&&(0,r.matchBrackets)(e,n.head-1,1)||n.head<e.doc.length&&(0,r.matchBrackets)(e,n.head+1,-1);if(!i||!i.end)return n;o=!0;let l=i.start.from==n.head?i.end.to:i.end.from;return t.EditorSelection.cursor(l)}),!!o&&(n(O(e,i)),!0)}},{key:"Mod-/",run:e=>{let{state:t}=e,n=t.doc.lineAt(t.selection.main.from),r=c(e.state,n.from);return r.line?l(e):!!r.block&&a(e)}},{key:"Alt-A",run:s},{key:"Ctrl-m",mac:"Shift-Alt-m",run:e=>(e.setTabFocusMode(),!0)}].concat([{key:"ArrowLeft",run:V,shift:X,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>W(e,!q(e)),shift:e=>Z(e,!q(e)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:e=>P(e,t=>j(e,t,!q(e))),shift:e=>Q(e,t=>j(e,t,!q(e))),preventDefault:!0},{key:"ArrowRight",run:F,shift:Y,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>W(e,q(e)),shift:e=>Z(e,q(e)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:e=>P(e,t=>j(e,t,q(e))),shift:e=>Q(e,t=>j(e,t,q(e))),preventDefault:!0},{key:"ArrowUp",run:U,shift:et,preventDefault:!0},{mac:"Cmd-ArrowUp",run:el,shift:ea},{mac:"Ctrl-ArrowUp",run:G,shift:eo},{key:"ArrowDown",run:J,shift:en,preventDefault:!0},{mac:"Cmd-ArrowDown",run:es,shift:ec},{mac:"Ctrl-ArrowDown",run:K,shift:ei},{key:"PageUp",run:G,shift:eo},{key:"PageDown",run:K,shift:ei},{key:"Home",run:e=>P(e,t=>j(e,t,!1)),shift:e=>Q(e,t=>j(e,t,!1)),preventDefault:!0},{key:"Mod-Home",run:el,shift:ea},{key:"End",run:e=>P(e,t=>j(e,t,!0)),shift:e=>Q(e,t=>j(e,t,!0)),preventDefault:!0},{key:"Mod-End",run:es,shift:ec},{key:"Enter",run:ew,shift:ew},{key:"Mod-a",run:({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:em,shift:em,preventDefault:!0},{key:"Delete",run:ep,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:ev,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>eg(e,!0),preventDefault:!0},{mac:"Mod-Backspace",run:e=>eu(e,t=>{let n=e.moveToLineBoundary(t,!1).head;return t.head>n?n:Math.max(0,t.head-1)}),preventDefault:!0},{mac:"Mod-Delete",run:e=>eu(e,t=>{let n=e.moveToLineBoundary(t,!0).head;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)}),preventDefault:!0}].concat(eD.map(e=>({mac:e.key,run:e.run,shift:e.shift})))),eL={key:"Tab",run:eM,shift:eE};e.s(["defaultKeymap",()=>eB,"deleteLine",()=>ek,"history",()=>g,"historyKeymap",()=>L,"indentWithTab",()=>eL,"redo",()=>S,"undo",()=>y],781044);var eT=e.i(593453);let eO="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e;class eP{constructor(e,t,n=0,r=e.length,o,i){this.test=i,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,r),this.bufferStart=n,this.normalize=o?e=>o(eO(e)):eO,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return -1;this.bufferPos=0,this.buffer=this.iter.value}return(0,t.codePointAt)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=(0,t.fromCodePoint)(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=(0,t.codePointSize)(e);let o=this.normalize(n);if(o.length)for(let e=0,t=r;;e++){let i=o.charCodeAt(e),l=this.match(i,t,this.bufferPos+this.bufferStart);if(e==o.length-1){if(l)return this.value=l,this;break}t==r&&e<n.length&&n.charCodeAt(e)==i&&t++}}}match(e,t,n){let r=null;for(let t=0;t<this.matches.length;t+=2){let o=this.matches[t],i=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?r={from:this.matches[t+1],to:n}:(this.matches[t]++,i=!0)),i||(this.matches.splice(t,2),t-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?r={from:t,to:n}:this.matches.push(1,t)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}"undefined"!=typeof Symbol&&(eP.prototype[Symbol.iterator]=function(){return this});let eR={from:-1,to:-1,match:/.*/.exec("")},eI="gm"+(null==/x/.unicode?"":"u");class eq{constructor(e,t,n,r=0,o=e.length){if(this.text=e,this.to=o,this.curLine="",this.done=!1,this.value=eR,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new eW(e,t,n,r,o);this.re=new RegExp(t,eI+((null==n?void 0:n.ignoreCase)?"i":"")),this.test=null==n?void 0:n.test,this.iter=e.iter();let i=e.lineAt(r);this.curLineStart=i.from,this.matchPos=eN(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,r=n+t[0].length;if(this.matchPos=eN(this.text,r+ +(n==r)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<r||n>this.value.to)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}}let eV=new WeakMap;class eF{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let r=eV.get(e);if(!r||r.from>=n||r.to<=t){let r=new eF(t,e.sliceString(t,n));return eV.set(e,r),r}if(r.from==t&&r.to==n)return r;let{text:o,from:i}=r;return i>t&&(o=e.sliceString(t,i)+o,i=t),r.to<n&&(o+=e.sliceString(r.to,n)),eV.set(e,new eF(i,o)),new eF(t,o.slice(t-i,n-i))}}class eW{constructor(e,t,n,r,o){this.text=e,this.to=o,this.done=!1,this.value=eR,this.matchPos=eN(e,r),this.re=new RegExp(t,eI+((null==n?void 0:n.ignoreCase)?"i":"")),this.test=null==n?void 0:n.test,this.flat=eF.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let e=this.flat.from+t.index,n=e+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,n,t)))return this.value={from:e,to:n,match:t},this.matchPos=eN(this.text,n+ +(e==n)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=eF.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function eN(e,t){if(t>=e.length)return t;let n=e.lineAt(t),r;for(;t<n.to&&(r=n.text.charCodeAt(t-n.from))>=56320&&r<57344;)t++;return t}function ez(e){let r=String(e.state.doc.lineAt(e.state.selection.main.head).number),o=(0,eT.default)("input",{class:"cm-textfield",name:"line",value:r});function i(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(o.value);if(!r)return;let{state:i}=e,l=i.doc.lineAt(i.selection.main.head),[,s,a,c,h]=r,u=c?+c.slice(1):0,f=a?+a:l.number;if(a&&h){let e=f/100;s&&(e=e*("-"==s?-1:1)+l.number/i.doc.lines),f=Math.round(i.doc.lines*e)}else a&&s&&(f=f*("-"==s?-1:1)+l.number);let d=i.doc.line(Math.max(1,Math.min(i.doc.lines,f))),m=t.EditorSelection.cursor(d.from+Math.max(0,Math.min(u,d.length)));e.dispatch({effects:[eU.of(!1),n.EditorView.scrollIntoView(m.from,{y:"center"})],selection:m}),e.focus()}return{dom:(0,eT.default)("form",{class:"cm-gotoLine",onkeydown:t=>{27==t.keyCode?(t.preventDefault(),e.dispatch({effects:eU.of(!1)}),e.focus()):13==t.keyCode&&(t.preventDefault(),i())},onsubmit:e=>{e.preventDefault(),i()}},(0,eT.default)("label",e.state.phrase("Go to line"),": ",o)," ",(0,eT.default)("button",{class:"cm-button",type:"submit"},e.state.phrase("go")),(0,eT.default)("button",{name:"close",onclick:()=>{e.dispatch({effects:eU.of(!1)}),e.focus()},"aria-label":e.state.phrase("close"),type:"button"},["×"]))}}"undefined"!=typeof Symbol&&(eq.prototype[Symbol.iterator]=eW.prototype[Symbol.iterator]=function(){return this});let eU=t.StateEffect.define(),eJ=t.StateField.define({create:()=>!0,update(e,t){for(let n of t.effects)n.is(eU)&&(e=n.value);return e},provide:e=>n.showPanel.from(e,e=>e?ez:null)}),e$=n.EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),eH={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},eG=t.Facet.define({combine:e=>(0,t.combineConfig)(e,eH,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})});function eK(e){let t=[eY,eX];return e&&t.push(eG.of(e)),t}let ej=n.Decoration.mark({class:"cm-selectionMatch"}),eQ=n.Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function e_(e,n,r,o){return(0==r||e(n.sliceDoc(r-1,r))!=t.CharCategory.Word)&&(o==n.doc.length||e(n.sliceDoc(o,o+1))!=t.CharCategory.Word)}let eX=n.ViewPlugin.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let r=e.state.facet(eG),{state:o}=e,i=o.selection;if(i.ranges.length>1)return n.Decoration.none;let l=i.main,s,a=null;if(l.empty){if(!r.highlightWordAroundCursor)return n.Decoration.none;let e=o.wordAt(l.head);if(!e)return n.Decoration.none;a=o.charCategorizer(l.head),s=o.sliceDoc(e.from,e.to)}else{let e=l.to-l.from;if(e<r.minSelectionLength||e>200)return n.Decoration.none;if(r.wholeWords){var c,h,u;if(s=o.sliceDoc(l.from,l.to),!(e_(a=o.charCategorizer(l.head),o,l.from,l.to)&&(c=a,h=l.from,u=l.to,c(o.sliceDoc(h,h+1))==t.CharCategory.Word&&c(o.sliceDoc(u-1,u))==t.CharCategory.Word)))return n.Decoration.none}else if(!(s=o.sliceDoc(l.from,l.to)))return n.Decoration.none}let f=[];for(let t of e.visibleRanges){let e=new eP(o.doc,s,t.from,t.to);for(;!e.next().done;){let{from:t,to:i}=e.value;if((!a||e_(a,o,t,i))&&(l.empty&&t<=l.from&&i>=l.to?f.push(eQ.range(t,i)):(t>=l.to||i<=l.from)&&f.push(ej.range(t,i)),f.length>r.maxMatches))return n.Decoration.none}}return n.Decoration.set(f)}},{decorations:e=>e.decorations}),eY=n.EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),eZ=t.Facet.define({combine:e=>(0,t.combineConfig)(e,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new tS(e),scrollToMatch:e=>n.EditorView.scrollIntoView(e)})});function e0(e){return e?[eZ.of(e),tb]:tb}class e1{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||function(e){try{return new RegExp(e,eI),!0}catch(e){return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(e,t)=>"n"==t?"\n":"r"==t?"\r":"t"==t?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new e6(this):new e3(this)}getCursor(e,n=0,r){let o=e.doc?e:t.EditorState.create({doc:e});return null==r&&(r=o.doc.length),this.regexp?e4(this,o,n,r):e5(this,o,n,r)}}class e2{constructor(e){this.spec=e}}function e5(e,n,r,o){var i,l;return new eP(n.doc,e.unquoted,r,o,e.caseSensitive?void 0:e=>e.toLowerCase(),e.wholeWord?(i=n.doc,l=n.charCategorizer(n.selection.main.head),(e,n,r,o)=>((o>e||o+r.length<n)&&(o=Math.max(0,e-2),r=i.sliceString(o,Math.min(i.length,n+2))),(l(e8(r,e-o))!=t.CharCategory.Word||l(e9(r,e-o))!=t.CharCategory.Word)&&(l(e9(r,n-o))!=t.CharCategory.Word||l(e8(r,n-o))!=t.CharCategory.Word))):void 0)}class e3 extends e2{constructor(e){super(e)}nextMatch(e,t,n){let r=e5(this.spec,e,n,e.doc.length).nextOverlapping();if(r.done){let n=Math.min(e.doc.length,t+this.spec.unquoted.length);r=e5(this.spec,e,0,n).nextOverlapping()}return r.done||r.value.from==t&&r.value.to==n?null:r.value}prevMatchInRange(e,t,n){for(let r=n;;){let n=Math.max(t,r-1e4-this.spec.unquoted.length),o=e5(this.spec,e,n,r),i=null;for(;!o.nextOverlapping().done;)i=o.value;if(i)return i;if(n==t)return null;r-=1e4}}prevMatch(e,t,n){let r=this.prevMatchInRange(e,0,t);return r||(r=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),r&&(r.from!=t||r.to!=n)?r:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=e5(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let o=e5(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!o.next().done;)r(o.value.from,o.value.to)}}function e4(e,n,r,o){var i;return new eq(n.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?(i=n.charCategorizer(n.selection.main.head),(e,n,r)=>!r[0].length||(i(e8(r.input,r.index))!=t.CharCategory.Word||i(e9(r.input,r.index))!=t.CharCategory.Word)&&(i(e9(r.input,r.index+r[0].length))!=t.CharCategory.Word||i(e8(r.input,r.index+r[0].length))!=t.CharCategory.Word)):void 0},r,o)}function e8(e,n){return e.slice((0,t.findClusterBreak)(e,n,!1),n)}function e9(e,n){return e.slice(n,(0,t.findClusterBreak)(e,n))}class e6 extends e2{nextMatch(e,t,n){let r=e4(this.spec,e,n,e.doc.length).next();return r.done&&(r=e4(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,n){for(let r=1;;r++){let o=Math.max(t,n-1e4*r),i=e4(this.spec,e,o,n),l=null;for(;!i.next().done;)l=i.value;if(l&&(o==t||l.from>o+10))return l;if(o==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,n)=>{if("&"==n)return e.match[0];if("$"==n)return"$";for(let t=n.length;t>0;t--){let r=+n.slice(0,t);if(r>0&&r<e.match.length)return e.match[r]+n.slice(t)}return t})}matchAll(e,t){let n=e4(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let o=e4(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!o.next().done;)r(o.value.from,o.value.to)}}let e7=t.StateEffect.define(),te=t.StateEffect.define(),tt=t.StateField.define({create:e=>new tn(td(e).create(),null),update(e,t){for(let n of t.effects)n.is(e7)?e=new tn(n.value.create(),e.panel):n.is(te)&&(e=new tn(e.query,n.value?tf:null));return e},provide:e=>n.showPanel.from(e,e=>e.panel)});class tn{constructor(e,t){this.query=e,this.panel=t}}let tr=n.Decoration.mark({class:"cm-searchMatch"}),to=n.Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),ti=n.ViewPlugin.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(tt))}update(e){let t=e.state.field(tt);(t!=e.startState.field(tt)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:e,panel:r}){if(!r||!e.spec.valid)return n.Decoration.none;let{view:o}=this,i=new t.RangeSetBuilder;for(let t=0,n=o.visibleRanges,r=n.length;t<r;t++){let{from:l,to:s}=n[t];for(;t<r-1&&s>n[t+1].from-500;)s=n[++t].to;e.highlight(o.state,l,s,(e,t)=>{let n=o.state.selection.ranges.some(n=>n.from==e&&n.to==t);i.add(e,t,n?to:tr)})}return i.finish()}},{decorations:e=>e.decorations});function tl(e){return t=>{let n=t.state.field(tt,!1);return n&&n.query.spec.valid?e(t,n):tg(t)}}let ts=tl((e,{query:n})=>{let{to:r}=e.state.selection.main,o=n.nextMatch(e.state,r,r);if(!o)return!1;let i=t.EditorSelection.single(o.from,o.to),l=e.state.facet(eZ);return e.dispatch({selection:i,effects:[tw(e,o),l.scrollToMatch(i.main,e)],userEvent:"select.search"}),tp(e),!0}),ta=tl((e,{query:n})=>{let{state:r}=e,{from:o}=r.selection.main,i=n.prevMatch(r,o,o);if(!i)return!1;let l=t.EditorSelection.single(i.from,i.to),s=e.state.facet(eZ);return e.dispatch({selection:l,effects:[tw(e,i),s.scrollToMatch(l.main,e)],userEvent:"select.search"}),tp(e),!0}),tc=tl((e,{query:n})=>{let r=n.matchAll(e.state,1e3);return!!r&&!!r.length&&(e.dispatch({selection:t.EditorSelection.create(r.map(e=>t.EditorSelection.range(e.from,e.to))),userEvent:"select.search.matches"}),!0)}),th=tl((e,{query:r})=>{let{state:o}=e,{from:i,to:l}=o.selection.main;if(o.readOnly)return!1;let s=r.nextMatch(o,i,i);if(!s)return!1;let a=s,c=[],h,u,f=[];a.from==i&&a.to==l&&(u=o.toText(r.getReplacement(a)),c.push({from:a.from,to:a.to,insert:u}),a=r.nextMatch(o,a.from,a.to),f.push(n.EditorView.announce.of(o.phrase("replaced match on line $",o.doc.lineAt(i).number)+".")));let d=e.state.changes(c);return a&&(h=t.EditorSelection.single(a.from,a.to).map(d),f.push(tw(e,a)),f.push(o.facet(eZ).scrollToMatch(h.main,e))),e.dispatch({changes:d,selection:h,effects:f,userEvent:"input.replace"}),!0}),tu=tl((e,{query:t})=>{if(e.state.readOnly)return!1;let r=t.matchAll(e.state,1e9).map(e=>{let{from:n,to:r}=e;return{from:n,to:r,insert:t.getReplacement(e)}});if(!r.length)return!1;let o=e.state.phrase("replaced $ matches",r.length)+".";return e.dispatch({changes:r,effects:n.EditorView.announce.of(o),userEvent:"input.replace.all"}),!0});function tf(e){return e.state.facet(eZ).createPanel(e)}function td(e,t){var n,r,o,i,l;let s=e.selection.main,a=s.empty||s.to>s.from+100?"":e.sliceDoc(s.from,s.to);if(t&&!a)return t;let c=e.facet(eZ);return new e1({search:(null!=(n=null==t?void 0:t.literal)?n:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:null!=(r=null==t?void 0:t.caseSensitive)?r:c.caseSensitive,literal:null!=(o=null==t?void 0:t.literal)?o:c.literal,regexp:null!=(i=null==t?void 0:t.regexp)?i:c.regexp,wholeWord:null!=(l=null==t?void 0:t.wholeWord)?l:c.wholeWord})}function tm(e){let t=(0,n.getPanel)(e,tf);return t&&t.dom.querySelector("[main-field]")}function tp(e){let t=tm(e);t&&t==e.root.activeElement&&t.select()}let tg=e=>{let n=e.state.field(tt,!1);if(n&&n.panel){let t=tm(e);if(t&&t!=e.root.activeElement){let r=td(e.state,n.query.spec);r.valid&&e.dispatch({effects:e7.of(r)}),t.focus(),t.select()}}else e.dispatch({effects:[te.of(!0),n?e7.of(td(e.state,n.query.spec)):t.StateEffect.appendConfig.of(tb)]});return!0},tv=e=>{let t=e.state.field(tt,!1);if(!t||!t.panel)return!1;let r=(0,n.getPanel)(e,tf);return r&&r.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:te.of(!1)}),!0},ty=[{key:"Mod-f",run:tg,scope:"editor search-panel"},{key:"F3",run:ts,shift:ta,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:ts,shift:ta,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:tv,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:e,dispatch:n})=>{let r=e.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:o,to:i}=r.main,l=[],s=0;for(let n=new eP(e.doc,e.sliceDoc(o,i));!n.next().done;){if(l.length>1e3)return!1;n.value.from==o&&(s=l.length),l.push(t.EditorSelection.range(n.value.from,n.value.to))}return n(e.update({selection:t.EditorSelection.create(l,s),userEvent:"select.search.matches"})),!0}},{key:"Mod-Alt-g",run:e=>{let r=(0,n.getPanel)(e,ez);if(!r){let o=[eU.of(!0)];null==e.state.field(eJ,!1)&&o.push(t.StateEffect.appendConfig.of([eJ,e$])),e.dispatch({effects:o}),r=(0,n.getPanel)(e,ez)}return r&&r.dom.querySelector("input").select(),!0}},{key:"Mod-d",run:({state:e,dispatch:r})=>{let{ranges:o}=e.selection;if(o.some(e=>e.from===e.to))return(({state:e,dispatch:n})=>{let{selection:r}=e,o=t.EditorSelection.create(r.ranges.map(n=>e.wordAt(n.head)||t.EditorSelection.cursor(n.head)),r.mainIndex);return!o.eq(r)&&(n(e.update({selection:o})),!0)})({state:e,dispatch:r});let i=e.sliceDoc(o[0].from,o[0].to);if(e.selection.ranges.some(t=>e.sliceDoc(t.from,t.to)!=i))return!1;let l=function(e,t){let{main:n,ranges:r}=e.selection,o=e.wordAt(n.head),i=o&&o.from==n.from&&o.to==n.to;for(let n=!1,o=new eP(e.doc,t,r[r.length-1].to);;)if(o.next(),o.done){if(n)return null;o=new eP(e.doc,t,0,Math.max(0,r[r.length-1].from-1)),n=!0}else{if(n&&r.some(e=>e.from==o.value.from))continue;if(i){let t=e.wordAt(o.value.from);if(!t||t.from!=o.value.from||t.to!=o.value.to)continue}return o.value}}(e,i);return!!l&&(r(e.update({selection:e.selection.addRange(t.EditorSelection.range(l.from,l.to),!1),effects:n.EditorView.scrollIntoView(l.to)})),!0)},preventDefault:!0}];class tS{constructor(e){this.view=e;let t=this.query=e.state.field(tt).query.spec;function n(e,t,n){return(0,eT.default)("button",{class:"cm-button",name:e,onclick:t,type:"button"},n)}this.commit=this.commit.bind(this),this.searchField=(0,eT.default)("input",{value:t.search,placeholder:tx(e,"Find"),"aria-label":tx(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=(0,eT.default)("input",{value:t.replace,placeholder:tx(e,"Replace"),"aria-label":tx(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=(0,eT.default)("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=(0,eT.default)("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=(0,eT.default)("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit}),this.dom=(0,eT.default)("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,n("next",()=>ts(e),[tx(e,"next")]),n("prev",()=>ta(e),[tx(e,"previous")]),n("select",()=>tc(e),[tx(e,"all")]),(0,eT.default)("label",null,[this.caseField,tx(e,"match case")]),(0,eT.default)("label",null,[this.reField,tx(e,"regexp")]),(0,eT.default)("label",null,[this.wordField,tx(e,"by word")]),...e.state.readOnly?[]:[(0,eT.default)("br"),this.replaceField,n("replace",()=>th(e),[tx(e,"replace")]),n("replaceAll",()=>tu(e),[tx(e,"replace all")])],(0,eT.default)("button",{name:"close",onclick:()=>tv(e),"aria-label":tx(e,"close"),type:"button"},["×"])])}commit(){let e=new e1({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:e7.of(e)}))}keydown(e){(0,n.runScopeHandlers)(this.view,e,"search-panel")?e.preventDefault():13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?ta:ts)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),th(this.view))}update(e){for(let t of e.transactions)for(let e of t.effects)e.is(e7)&&!e.value.eq(this.query)&&this.setQuery(e.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(eZ).top}}function tx(e,t){return e.state.phrase(t)}let tk=/[\s\.,:;?!]/;function tw(e,{from:t,to:r}){let o=e.state.doc.lineAt(t),i=e.state.doc.lineAt(r).to,l=Math.max(o.from,t-30),s=Math.min(i,r+30),a=e.state.sliceDoc(l,s);if(l!=o.from){for(let e=0;e<30;e++)if(!tk.test(a[e+1])&&tk.test(a[e])){a=a.slice(e);break}}if(s!=i){for(let e=a.length-1;e>a.length-30;e--)if(!tk.test(a[e-1])&&tk.test(a[e])){a=a.slice(0,e);break}}return n.EditorView.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${o.number}.`)}let tA=n.EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),tb=[tt,t.Prec.low(ti),tA];e.s(["closeSearchPanel",()=>tv,"highlightSelectionMatches",()=>eK,"openSearchPanel",()=>tg,"search",()=>e0,"searchKeymap",()=>ty],808800)}]);