(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,195883,e=>{"use strict";var t=e.i(843476);function r({children:e,gap:r="0",alignment:a="start",distribution:n="start",className:o="",style:i,width:s="100"}){let l=["d-flex flex-column","25"===s?"w-25":"50"===s?"w-50":"75"===s?"w-75":"100"===s?"w-100":"auto"===s?"w-auto":"",`gap-${r}`,`align-items-${a}`,`justify-content-${"between"===n?"between":"around"===n?"around":"evenly"===n?"evenly":n}`,o].filter(Boolean).join(" "),c={...i,..."string"==typeof s&&!["25","50","75","100","auto"].includes(s)?{width:s}:{}};return(0,t.jsx)("div",{className:l,style:c,children:e})}e.s(["default",()=>r])},958155,e=>{"use strict";var t=e.i(843476),r=e.i(195883);function a({children:e,style:a}){return(0,t.jsx)(r.default,{gap:"3",alignment:"start",className:"px-3 pb-3",style:a,children:e})}e.s(["default",()=>a])},701870,e=>{"use strict";async function t(e,t,r){return e({...r,locateFile:e=>(console.log("locateFile:",e),e.endsWith(".wasm"))?new URL(e,location.origin).toString():e,...t?{wasmModule:t}:{}})}function r(e,t){return console.time(e),t().finally(()=>console.timeEnd(e))}async function a(e,t){if(e.aborted)throw new DOMException("AbortError","AbortError");return Promise.race([t,new Promise((t,r)=>{e.addEventListener("abort",()=>r(new DOMException("AbortError","AbortError")))})])}e.s(["abortable",()=>a,"initEmscriptenModule",()=>t,"timed",()=>r],701870)},102579,e=>{e.v("/_next/static/media/imageWorker.2876e1cb.ts")},255519,e=>{"use strict";let t=Symbol("Comlink.proxy"),r=Symbol("Comlink.endpoint"),a=Symbol("Comlink.releaseProxy"),n=Symbol("Comlink.finalizer"),o=Symbol("Comlink.thrown"),i=e=>"object"==typeof e&&null!==e||"function"==typeof e,s=new Map([["proxy",{canHandle:e=>i(e)&&e[t],serialize(e){let{port1:t,port2:r}=new MessageChannel;return l(e,t),[r,[r]]},deserialize:e=>(e.start(),d(e))}],["throw",{canHandle:e=>i(e)&&o in e,serialize:({value:e})=>[e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[]],deserialize(e){if(e.isError)throw Object.assign(Error(e.value.message),e.value);throw e.value}}]]);function l(e,r=globalThis,a=["*"]){r.addEventListener("message",function i(s){let d;if(!s||!s.data)return;if(!function(e,t){for(let r of e)if(t===r||"*"===r||r instanceof RegExp&&r.test(t))return!0;return!1}(a,s.origin))return void console.warn(`Invalid origin '${s.origin}' for comlink proxy`);let{id:u,type:m,path:g}=Object.assign({path:[]},s.data),h=(s.data.argumentList||[]).map(x);try{var p,w,y;let r=g.slice(0,-1).reduce((e,t)=>e[t],e),a=g.reduce((e,t)=>e[t],e);switch(m){case"GET":d=a;break;case"SET":r[g.slice(-1)[0]]=x(s.data.value),d=!0;break;case"APPLY":d=a.apply(r,h);break;case"CONSTRUCT":p=new a(...h),d=Object.assign(p,{[t]:!0});break;case"ENDPOINT":{let{port1:t,port2:r}=new MessageChannel;l(e,r),w=t,y=[t],f.set(w,y),d=w}break;case"RELEASE":d=void 0;break;default:return}}catch(e){d={value:e,[o]:0}}Promise.resolve(d).catch(e=>({value:e,[o]:0})).then(t=>{let[a,o]=b(t);r.postMessage(Object.assign(Object.assign({},a),{id:u}),o),"RELEASE"===m&&(r.removeEventListener("message",i),c(r),n in e&&"function"==typeof e[n]&&e[n]())}).catch(e=>{let[t,a]=b({value:TypeError("Unserializable return value"),[o]:0});r.postMessage(Object.assign(Object.assign({},t),{id:u}),a)})}),r.start&&r.start()}function c(e){"MessagePort"===e.constructor.name&&e.close()}function d(e,t){let n=new Map;return e.addEventListener("message",function(e){let{data:t}=e;if(!t||!t.id)return;let r=n.get(t.id);if(r)try{r(t)}finally{n.delete(t.id)}}),function e(t,n,o=[],i=function(){}){let s,l=!1,c=new Proxy(i,{get(r,i){if(u(l),i===a)return()=>{h&&h.unregister(c),m(t),n.clear(),l=!0};if("then"===i){if(0===o.length)return{then:()=>c};let e=w(t,n,{type:"GET",path:o.map(e=>e.toString())}).then(x);return e.then.bind(e)}return e(t,n,[...o,i])},set(e,r,a){u(l);let[i,s]=b(a);return w(t,n,{type:"SET",path:[...o,r].map(e=>e.toString()),value:i},s).then(x)},apply(a,i,s){u(l);let c=o[o.length-1];if(c===r)return w(t,n,{type:"ENDPOINT"}).then(x);if("bind"===c)return e(t,n,o.slice(0,-1));let[d,m]=p(s);return w(t,n,{type:"APPLY",path:o.map(e=>e.toString()),argumentList:d},m).then(x)},construct(e,r){u(l);let[a,i]=p(r);return w(t,n,{type:"CONSTRUCT",path:o.map(e=>e.toString()),argumentList:a},i).then(x)}});return s=(g.get(t)||0)+1,g.set(t,s),h&&h.register(c,t,c),c}(e,n,[],t)}function u(e){if(e)throw Error("Proxy has been released and is not useable")}function m(e){return w(e,new Map,{type:"RELEASE"}).then(()=>{c(e)})}let g=new WeakMap,h="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(g.get(e)||0)-1;g.set(e,t),0===t&&m(e)});function p(e){var t;let r=e.map(b);return[r.map(e=>e[0]),(t=r.map(e=>e[1]),Array.prototype.concat.apply([],t))]}let f=new WeakMap;function b(e){for(let[t,r]of s)if(r.canHandle(e)){let[a,n]=r.serialize(e);return[{type:"HANDLER",name:t,value:a},n]}return[{type:"RAW",value:e},f.get(e)||[]]}function x(e){switch(e.type){case"HANDLER":return s.get(e.name).deserialize(e.value);case"RAW":return e.value}}function w(e,t,r,a){return new Promise(n=>{let o=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(o,n),e.start&&e.start(),e.postMessage(Object.assign({id:o},r),a)})}e.s(["expose",()=>l,"wrap",()=>d])},469214,e=>{e.v(e.b(["static/chunks/faa99d80e8561eab.js","static/chunks/turbopack-102d9faa43b1bcc8.js"]))},653728,e=>{"use strict";var t=e.i(843476),r=e.i(958155),a=e.i(271645),n=e.i(255519),o=e.i(701870);class i{_queue=Promise.resolve();_worker;_workerApi;_workerTimeout;_terminateWorker(){this._worker&&(this._worker.terminate(),this._worker=void 0,this._workerApi=void 0)}_startWorker(){this._worker=new Worker(e.r(469214),{type:"module",type:void 0}),this._workerApi=n.wrap(this._worker)}}for(let e of["avifEncode","avifDecode","mozjpegEncode"])i.prototype[e]=function(t,...r){return this._queue=this._queue.catch(()=>{}).then(async()=>{if(t.aborted)throw new DOMException("AbortError","AbortError");clearTimeout(this._workerTimeout),this._worker||this._startWorker();let a=()=>this._terminateWorker();return t.addEventListener("abort",a),(0,o.abortable)(t,this._workerApi[e](...r)).finally(()=>{t.removeEventListener("abort",a),this._workerTimeout=setTimeout(()=>{this._terminateWorker()},1e4)})}),this._queue};let s=new i;function l(){let[e,n]=(0,a.useState)("Ready"),[o,i]=(0,a.useState)(null),[l,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(0),[m,g]=(0,a.useState)(0),[h,p]=(0,a.useState)("encode"),[f,b]=(0,a.useState)("avif"),x=async e=>{let t=e.target.files?.[0];if(!t)return;n("Processing..."),i(null),c(null);let r=new AbortController,a=URL.createObjectURL(t),o="image/avif"===t.type||t.name.toLowerCase().endsWith(".avif")?"decode":"encode";p(o),u(t.size);try{if("encode"===o){let e,o=new Image;o.src=a,await new Promise(e=>o.onload=e);let l=document.createElement("canvas");l.width=o.width,l.height=o.height;let d=l.getContext("2d");d.drawImage(o,0,0);let u=d.getImageData(0,0,o.width,o.height);n(`Encoding to ${f.toUpperCase()} (background worker)...`),e="avif"===f?await s.avifEncode(r.signal,u,{quality:65,speed:8,subsample:2}):await s.mozjpegEncode(r.signal,u,{quality:75,baseline:!1,arithmetic:!1,progressive:!0,optimize_coding:!0,smoothing:0,color_space:3,quant_table:3,trellis_multipass:!1,trellis_opt_zero:!1,trellis_opt_table:!1,trellis_loops:1,auto_subsample:!0,chroma_subsample:2,separate_chroma_quality:!1,chroma_quality:75});let m="avif"===f?"image/avif":"image/jpeg",h=new Blob([e],{type:m}),p=URL.createObjectURL(h);c(p),g(e.byteLength),i(a);let b=((1-e.byteLength/t.size)*100).toFixed(1);n(`Encoded to ${f.toUpperCase()}! Reduced by ${b}%`)}else{n("Decoding AVIF (background worker)..."),i(a);let e=await t.arrayBuffer(),o=await s.avifDecode(r.signal,e),l=document.createElement("canvas");l.width=o.width,l.height=o.height,l.getContext("2d").putImageData(o,0,0);let d=l.toDataURL("image/png");c(d),g(e.byteLength),n(`Decoded AVIF → ${o.width}\xd7${o.height}`)}}catch(e){n(`Error: ${e.message||e}`),console.error(e)}};return(0,a.useEffect)(()=>()=>{o&&URL.revokeObjectURL(o),l&&URL.revokeObjectURL(l)},[o,l]),(0,a.useEffect)(()=>{console.log("Selected codec:",f)},[f]),(0,t.jsx)(r.default,{children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto p-12",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold mb-8 text-center",children:"Squoosh-Style Image Processor"}),(0,t.jsxs)("div",{className:"flex justify-center gap-8 mb-12",children:[(0,t.jsx)("button",{onClick:()=>b("avif"),disabled:"decode"===h,className:`px-10 py-5 rounded-2xl font-bold text-lg transition-all shadow-lg ${"avif"===f&&"encode"===h?"bg-purple-600 text-white scale-105":"bg-gray-200 text-gray-600 hover:bg-gray-300"} ${"decode"===h?"opacity-50 cursor-not-allowed":""}`,children:"Encode to AVIF"}),(0,t.jsx)("button",{onClick:()=>b("mozjpeg"),disabled:"decode"===h,className:`px-10 py-5 rounded-2xl font-bold text-lg transition-all shadow-lg ${"mozjpeg"===f&&"encode"===h?"bg-blue-600 text-white scale-105":"bg-gray-200 text-gray-600 hover:bg-gray-300"} ${"decode"===h?"opacity-50 cursor-not-allowed":""}`,children:"Encode to JPEG (MozJPEG)"})]}),(0,t.jsxs)("p",{className:"text-lg text-gray-600 mb-10 text-center max-w-3xl mx-auto",children:["Upload any image to ",(0,t.jsx)("strong",{children:"encode"})," using the selected codec",(0,t.jsx)("br",{}),"OR upload an"," ",(0,t.jsx)("code",{className:"bg-gray-200 px-2 py-1 rounded",children:".avif"})," file to"," ",(0,t.jsx)("strong",{children:"decode"})," and view it",(0,t.jsx)("br",{}),(0,t.jsx)("em",{className:"text-sm",children:"(All processing runs in a shared Web Worker — UI stays perfectly smooth)"})]}),(0,t.jsx)("div",{className:"flex justify-center mb-12",children:(0,t.jsx)("input",{type:"file",accept:"image/*,.avif",onChange:x,className:"block w-full max-w-lg text-lg file:mr-6 file:py-5 file:px-10 file:rounded-2xl file:border-0 file:bg-gradient-to-r file:from-indigo-600 file:to-pink-600 file:text-white hover:file:from-indigo-700 hover:file:to-pink-700 cursor-pointer"})}),(0,t.jsx)("p",{className:"text-center text-2xl font-medium text-gray-800 mb-16",children:e}),(o||l)&&(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-16 items-start",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold mb-4",children:"encode"===h?"Original Image":"Input AVIF File"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-6",children:["Size: ",(d/1024).toFixed(1)," KB"]}),"encode"===h&&o&&(0,t.jsx)("img",{src:o,alt:"Original",className:"rounded-2xl shadow-2xl border max-w-full mx-auto"}),"decode"===h&&(0,t.jsx)("div",{className:"bg-gray-100 border-4 border-dashed rounded-2xl p-12 text-gray-500",children:(0,t.jsxs)("p",{className:"text-xl",children:[".avif file",(0,t.jsx)("br",{}),"(no direct preview)"]})})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold mb-4 text-green-600",children:"encode"===h?`Encoded ${f.toUpperCase()}`:"Decoded Image"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-8",children:["Size: ",(m/1024).toFixed(1)," KB"]}),l&&(0,t.jsxs)(t.Fragment,{children:["encode"===h&&(0,t.jsxs)("a",{href:l,download:`converted.${"avif"===f?"avif":"jpg"}`,className:"inline-block mb-8 px-10 py-5 bg-green-600 text-white text-xl font-bold rounded-2xl hover:bg-green-700 shadow-xl transition",children:["Download ",f.toUpperCase()]}),(0,t.jsx)("img",{src:l,alt:"encode"===h?"Encoded result":"Decoded from AVIF",className:"rounded-2xl shadow-2xl border max-w-full mx-auto"})]})]})]})]})})}e.s(["default",()=>l],653728)}]);